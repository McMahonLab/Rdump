#Calculating Proportions of taxa binned by number of EET genes accross entire dataset, normalized by sample to give each lake the same weight.
#Step 1 is to make a file where I have EET, METABOLIC data, (done) and then also a file with taxonomic data for each of the bins. See /Users/cnolmsted/Documents/R_scripts/MetagenomicsofEETinLakes/TaxanomicFileMakery.md
#The 'abundance' of each taxon is going to actually be number of otus in a taxon in a lake divided by the number of samples in that lake, averaged with that value across all lakes.  

#also make sure you've made Totals_S which will have more samples/lakes than are yet in METABOLIC from /Users/cnolmsted/Documents/MchMahon_Lab/Mentee_Documents/2020_Things/2020_summer_project_Roger-Ort/R/GraphingBinsUniqueByLake_cno.R

library(ggplot2)
library(stringr)
library(cowplot)
library(dplyr)
theme_set(theme_cowplot())

Taxonomy <- read.csv(file = "/Users/cnolmsted/Documents/MchMahon_Lab/METABOLIC/Editing_Metabolic/DOCMAGS-50-10-PQT.csv", header = TRUE, stringsAsFactors=FALSE)
#MetabolicEET <- read.csv(file = "/Users/cnolmsted/Documents/MchMahon_Lab/METABOLIC/Editing_Metabolic/METABOILCandEETinfo.csv", header = FALSE, stringsAsFactors=FALSE)
MetabolicEET <- read.csv(file = "/Users/cnolmsted/Documents/MchMahon_Lab/EET_sequencing_stuff/FeGenie/EET-finder-Pipeline_plusD-Bond/Edited_Pipeline_Files/METABOILCandEETinfoCorrected.csv", header = FALSE, stringsAsFactors=FALSE)

colnames(MetabolicEET) <- c("user_genome","rgy","4-aminobutyrate aminotransferase and related aminotransferases","aminotransferase class I and II","phosphoserine aminotransferase","ornithine/acetylornithine aminotransferase","branched-chain amino acid aminotransferase/4-amino-4-deoxychorismate lyase","aspartate/tyrosine/aromatic aminotransferase","histidinol-phosphate/aromatic aminotransferase","serine-pyruvate aminotransferase/archaeal aspartate aminotransferase","acetate => acetaldehyde","acetaldehyde => ethanol","acyl-CoA dehydrogenase","catA","ubiX","bsdC","bcrC","bcrB","bcrA","bcrD","cellobiosidase","cellulase","beta-glucosidase","arabinosidase","beta-glucuronidase","alpha-L-rhamnosidase","mannan endo-1 4-beta-mannosidase","alpha-D-xyloside xylohydrolase","beta-xylosidase","beta-mannosidase","beta-galactosidase","alpha-amylase","glucoamylase","pullulanase","isoamylase","chitiniase","hexosaminidase","porA","adh","ldh","acdA","ack","pta","acs","pflD","mxaF","mdh","mauA","mauB","fdhA","fghA","frmA","mycoS_dep_FDH","fae","fdoG","fdwB","fdoH","fdhA","fdhB","coxS","coxM","coxL","pmoA","pmoB","pmoC","mmoB","mmoD","mcrA","mcrB","mcrC","Form I","Form II","Form II/III","Form III","Form IV","prpE","mcr","K15017","K14466","4hbl","K18861","E6.2.1.56","abfD","cdhD","cdhE","cooS","aclA","aclB","amoA","amoB","amoC","anfD","anfK","anfG","nifD","nifK","vnfD","vnfK","vnfG","nifH","nxrA","nxrB","napA","napB","narG","narH","nrfH","nrfA","nrfD","nirB","nirD","nirK","nirS","octR","norB","norC","nosD","nosZ","hzoA","hzsA","fccB","sqr","dsrD","dsrA","dsrB","sdo","sor","sreA","sreB","sreC","soxB","soxY","soxC","asrA","asrB","asrC","aprA","sat","phsA","fefe-group-a13","fefe-group-a2","fefe-group-a4","fefe-group-b","fefe-group-c1","fefe-group-c2","fefe-group-c3","fe","nife-group-1","nife-group-2ade","nife-group-2bc","nife-group-3abd","nife-group-3c","nife-group-4a-g","nife-group-4hi","nuoA","nuoB","nuoC","NdhA","NdhB","NdhC","sdhC","sdhD","petA","petB","fbcH","atpA (V/A-type)","atpB (V/A-type)","atpA (F-type)","atpD (F-type)","coxA","coxB","ccoN","ccoO","ccoP","cyoA","cyoD","cyoB","cyoC","cydA","cydB","qoxA","qoxB","ureC","ureB","ureA","E3.8.1.2","pcpC","cprA","pceA","pcrA","pcrB","cld","aoxA","aoxB","arsC1","arsC2","ygfM","xdhD","YgfK","nthA","nthB","mtrC","mtrB","totalEET","RespEET","OxidEET","undescribed","dissimilar","Resp80","RespNoN","NitrMHC")

TaxMetEet <- merge(Taxonomy, MetabolicEET, by = "user_genome")

#putting the lake  column into TaxMetEet
TaxMetEet <- merge(x = TaxMetEet, y = Totals_S[ , c("Sample", "Lake")], by = "Sample", all.x=TRUE)

#Paceibacteria_A to Paceibacteria and removing other '_A'
TaxMetEet <- TaxMetEet %>% mutate(Class = ifelse(Class == "Paceibacteria_A", "Paceibacteria", Class))
TaxMetEet <- TaxMetEet %>% mutate(Phylum = ifelse(Phylum == "Bdellovibrionota_B", "Bdellovibrionota", Phylum))
TaxMetEet <- TaxMetEet %>% mutate(Phylum = ifelse(Phylum == "Chloroflexota_A", "Chloroflexota", Phylum))
TaxMetEet <- TaxMetEet %>% mutate(Phylum = ifelse(Phylum == "Verrucomicrobiota_A", "Verrucomicrobiota", Phylum))
TaxMetEet <- TaxMetEet %>% mutate(Phylum = ifelse(Phylum == "Desulfobacterota_A", "Desulfobacterota", Phylum))

#Getting counts for how many samples are in each lake. 
SampleCounts <- TaxMetEet %>% count(Lake, Sample)
LakeSampleCounts <- SampleCounts %>% count(Lake)

#Counting various taxonomic levels
PhylumLakeCounts <- TaxMetEet %>% count(Lake, Phylum)
ClassLakeCounts <- TaxMetEet %>% count(Lake, Class)
PhylumClassCounts <- TaxMetEet %>% count(Phylum, Class)
#rename all numbered classes labeled the higher phylum as in "other_[Phylum]"
Numbered <- ClassLakeCounts[grep("[0-9]", ClassLakeCounts$Class), ]
Numbered <- unique(Numbered$Class)
#not necessary, but i guess this is how I can use grep
#UpClassed <- data.frame(Phylum=character(), Class=character(), stringsAsFactors=FALSE)
#for (val in Numbered) {
#  UpClassed[nrow(UpClassed) + 1,] = c(PhylumClassCounts[grep(val,PhylumClassCounts$Class), ][c(1)],val)
#}
#necessary, and I use gsub and grep all in one. 
ClassLakeCountsR <- ClassLakeCounts
for (val in Numbered) {
  ClassLakeCountsR$Class <- gsub(val, paste("",PhylumClassCounts[grep(val,PhylumClassCounts$Class), ][c(1)], sep = ""), ClassLakeCountsR$Class)
}


#Time to add up all ratios of organisms per lake, and then ... oh wait, I need to first split up TaxMetEet by EET, total, ox, and red and then redo the above sorta. 
#need for each # of EET genes, calculate the proportion of bacteria that are in a given class. 
#So X, variable,value ... should be: Class/group, #EET, proportion in that # ... 'X' in "#EET" will represent proportion of class regardless of EET. 
#this is not going to be abundance and probably not even diversity since there's no filtering out less-sequenced members or anything, but values in the end will be "proportion of sequenced OTUs"
#after partitioning TaxMetEet into files like ClassLakeCountsR, for each class group add up: (number of bins in given lake's class (n))/(#samples in that lake) = value , for each class divide total value of class by total value accross classes and you get "proportion of sequenced OTUs"

#adding new column with 'value' as described above
ClassLakeCountsRnn <- merge(ClassLakeCountsR, LakeSampleCounts, by="Lake")
ClassLakeCountsRnn$value <- c(ClassLakeCountsRnn$n.x/ClassLakeCountsRnn$n.y)
ClassCountsX <- aggregate(ClassLakeCountsRnn$value, by=list(ClassLakeCountsRnn$Class), FUN = sum) #Chlorobia should be about 31.4389 if I calculated that right
names(ClassCountsX)[names(ClassCountsX) == "x"] <- "ClassValue"
names(ClassCountsX)[names(ClassCountsX) == "Group.1"] <- "Group"
ClassCountsX$EETcount <- c("X")
ClassCountsX$OTU.Proportion <- c(ClassCountsX$ClassValue/ave(ClassCountsX$ClassValue, ClassCountsX$EETcount, FUN = sum))
#ggplot(ClassCountsX, aes(x = EETcount, y = OTU.Proportion,fill=Group)) + geom_bar(stat='identity', color="black", size=.2) + geom_text(aes(label = Group), position = position_stack(vjust = .5))
#now just to filter out each of the EET numbers and add it to ClassCountsX

EetRange <- 0:24

for (ENX in EetRange) {
  ClassLakeCounts <- filter(TaxMetEet, totalEET == ENX) %>% count(Lake, Class)
  ########################
  ClassLakeCountsR <- ClassLakeCounts
  for (val in Numbered) {
    ClassLakeCountsR$Class <- gsub(val, paste("",PhylumClassCounts[grep(val,PhylumClassCounts$Class), ][c(1)], sep = ""), ClassLakeCountsR$Class)
  }
  ClassLakeCountsRnn <- merge(ClassLakeCountsR, LakeSampleCounts, by="Lake")
  ClassLakeCountsRnn$value <- c(ClassLakeCountsRnn$n.x/ClassLakeCountsRnn$n.y)
  ClassCountsT <- aggregate(ClassLakeCountsRnn$value, by=list(ClassLakeCountsRnn$Class), FUN = sum) #Chlorobia should be about 31.4389 if I calculated that right
  names(ClassCountsT)[names(ClassCountsT) == "x"] <- "ClassValue"
  names(ClassCountsT)[names(ClassCountsT) == "Group.1"] <- "Group"
  ClassCountsT$EETcount <- c(ENX)
  ClassCountsT$OTU.Proportion <- c(ClassCountsT$ClassValue/ave(ClassCountsT$ClassValue, ClassCountsT$EETcount, FUN = sum))
  
  ClassCountsX <- rbind(ClassCountsX,ClassCountsT)
}

str(ClassCountsX)
#tell what specific order of 'levels' to be in.
ClassCountsX$EETcount <- factor(ClassCountsX$EETcount, levels = c("X",0:24))
levels(ClassCountsX$EETcount)

ggplot(ClassCountsX, aes(x = EETcount, y = OTU.Proportion,fill=Group)) + geom_bar(stat='identity', color="black", size=.2) + geom_text(aes(label = Group), position = position_stack(vjust = .5),size = 2.5) + theme(legend.position = "none") 
#without tiny fractions being labeled:
ggplot(ClassCountsX, aes(x = EETcount, y = OTU.Proportion,fill=Group)) + geom_bar(stat='identity', color="black", size=.2) + geom_text(aes(label = ifelse(OTU.Proportion > .005, Group, "")), position = position_stack(vjust = .5),size = 2.5) + theme(legend.position = "none") + ylab("Proportion of OTUs") + xlab("Number of EET proteins")

#now I want to do the same except for only those that have both oxidative and a reductive EET gene
#first rerun above line 69
#then run below
EetRange <- 2:23

for (ENX in EetRange) {
  ClassLakeCounts <- filter(TaxMetEet, totalEET == ENX & OxidEET > 0 & RespEET > 0) %>% count(Lake, Class)
  ########################
  ClassLakeCountsR <- ClassLakeCounts
  for (val in Numbered) {
    ClassLakeCountsR$Class <- gsub(val, paste("",PhylumClassCounts[grep(val,PhylumClassCounts$Class), ][c(1)], sep = ""), ClassLakeCountsR$Class)
  }
  ClassLakeCountsRnn <- merge(ClassLakeCountsR, LakeSampleCounts, by="Lake")
  ClassLakeCountsRnn$value <- c(ClassLakeCountsRnn$n.x/ClassLakeCountsRnn$n.y)
  ClassCountsT <- aggregate(ClassLakeCountsRnn$value, by=list(ClassLakeCountsRnn$Class), FUN = sum) #Chlorobia should be about 31.4389 if I calculated that right
  names(ClassCountsT)[names(ClassCountsT) == "x"] <- "ClassValue"
  names(ClassCountsT)[names(ClassCountsT) == "Group.1"] <- "Group"
  ClassCountsT$EETcount <- c(ENX)
  ClassCountsT$OTU.Proportion <- c(ClassCountsT$ClassValue/ave(ClassCountsT$ClassValue, ClassCountsT$EETcount, FUN = sum))
  
  ClassCountsX <- rbind(ClassCountsX,ClassCountsT)
}
str(ClassCountsX)
ClassCountsX$EETcount <- factor(ClassCountsX$EETcount, levels = c("X",2:23))
levels(ClassCountsX$EETcount)
ggplot(ClassCountsX, aes(x = EETcount, y = OTU.Proportion,fill=Group)) + geom_bar(stat='identity', color="black", size=.2) + theme(legend.position = "none") + geom_text(aes(label = Group), position = position_stack(vjust = .5),size = 2.5) 

ggplot(ClassCountsX, aes(x = EETcount, y = OTU.Proportion,fill=Group)) + geom_bar(stat='identity', color="black", size=.2) + theme(legend.position = "none") + geom_text(aes(label = ifelse(OTU.Proportion > .005, Group, "")), position = position_stack(vjust = .5),size = 2.5) 



#now I want to do the same except for only oxidizing EET genes.
#first rerun above line 69
#then run below
EetRange <- 0:15

for (ENX in EetRange) {
  ClassLakeCounts <- filter(TaxMetEet, OxidEET == ENX) %>% count(Lake, Class)
  ########################
  ClassLakeCountsR <- ClassLakeCounts
  for (val in Numbered) {
    ClassLakeCountsR$Class <- gsub(val, paste("",PhylumClassCounts[grep(val,PhylumClassCounts$Class), ][c(1)], sep = ""), ClassLakeCountsR$Class)
  }
  ClassLakeCountsRnn <- merge(ClassLakeCountsR, LakeSampleCounts, by="Lake")
  ClassLakeCountsRnn$value <- c(ClassLakeCountsRnn$n.x/ClassLakeCountsRnn$n.y)
  ClassCountsT <- aggregate(ClassLakeCountsRnn$value, by=list(ClassLakeCountsRnn$Class), FUN = sum) #Chlorobia should be about 31.4389 if I calculated that right
  names(ClassCountsT)[names(ClassCountsT) == "x"] <- "ClassValue"
  names(ClassCountsT)[names(ClassCountsT) == "Group.1"] <- "Group"
  ClassCountsT$EETcount <- c(ENX)
  ClassCountsT$OTU.Proportion <- c(ClassCountsT$ClassValue/ave(ClassCountsT$ClassValue, ClassCountsT$EETcount, FUN = sum))
  
  ClassCountsX <- rbind(ClassCountsX,ClassCountsT)
}
str(ClassCountsX)
ClassCountsX$EETcount <- factor(ClassCountsX$EETcount, levels = c("X",0:15))
levels(ClassCountsX$EETcount)
ggplot(ClassCountsX, aes(x = EETcount, y = OTU.Proportion,fill=Group)) + geom_bar(stat='identity', color="black", size=.2) + theme(legend.position = "none") + geom_text(aes(label = Group), position = position_stack(vjust = .5),size = 2.5) 

ggplot(ClassCountsX, aes(x = EETcount, y = OTU.Proportion,fill=Group)) + geom_bar(stat='identity', color="black", size=.2) + theme(legend.position = "none") + geom_text(aes(label = ifelse(OTU.Proportion > .005, Group, "")), position = position_stack(vjust = .5),size = 2.5) + ylab("Proportion of OTUs") + xlab("Number of EET proteins")
       

#now I want to do the same except for only reducing EET genes.
#first rerun above line 69
#then run below
EetRange <- 0:18

for (ENX in EetRange) {
  ClassLakeCounts <- filter(TaxMetEet, RespEET == ENX) %>% count(Lake, Class)
  ########################
  ClassLakeCountsR <- ClassLakeCounts
  for (val in Numbered) {
    ClassLakeCountsR$Class <- gsub(val, paste("",PhylumClassCounts[grep(val,PhylumClassCounts$Class), ][c(1)], sep = ""), ClassLakeCountsR$Class)
  }
  ClassLakeCountsRnn <- merge(ClassLakeCountsR, LakeSampleCounts, by="Lake")
  ClassLakeCountsRnn$value <- c(ClassLakeCountsRnn$n.x/ClassLakeCountsRnn$n.y)
  ClassCountsT <- aggregate(ClassLakeCountsRnn$value, by=list(ClassLakeCountsRnn$Class), FUN = sum) #Chlorobia should be about 31.4389 if I calculated that right
  names(ClassCountsT)[names(ClassCountsT) == "x"] <- "ClassValue"
  names(ClassCountsT)[names(ClassCountsT) == "Group.1"] <- "Group"
  ClassCountsT$EETcount <- c(ENX)
  ClassCountsT$OTU.Proportion <- c(ClassCountsT$ClassValue/ave(ClassCountsT$ClassValue, ClassCountsT$EETcount, FUN = sum))
  
  ClassCountsX <- rbind(ClassCountsX,ClassCountsT)
}

ClassCountsX$EETcount <- factor(ClassCountsX$EETcount, levels = c("X",0:18))
ggplot(ClassCountsX, aes(x = EETcount, y = OTU.Proportion,fill=Group)) + geom_bar(stat='identity', color="black", size=.2) + theme(legend.position = "none") + geom_text(aes(label = Group), position = position_stack(vjust = .5),size = 2.5)
ggplot(ClassCountsX, aes(x = EETcount, y = OTU.Proportion,fill=Group)) + geom_bar(stat='identity', color="black", size=.2) + theme(legend.position = "none") + geom_text(aes(label = ifelse(OTU.Proportion > .005, Group, "")), position = position_stack(vjust = .5),size = 2.5) + ylab("Proportion of OTUs") + xlab("Number of EET proteins")


#now I want to do the same except for only Undescribed EET genes.
#first rerun above line 69
#then run below
EetRange <- 0:16

for (ENX in EetRange) {
  ClassLakeCounts <- filter(TaxMetEet, undescribed == ENX) %>% count(Lake, Class)
  ########################
  ClassLakeCountsR <- ClassLakeCounts
  for (val in Numbered) {
    ClassLakeCountsR$Class <- gsub(val, paste("",PhylumClassCounts[grep(val,PhylumClassCounts$Class), ][c(1)], sep = ""), ClassLakeCountsR$Class)
  }
  ClassLakeCountsRnn <- merge(ClassLakeCountsR, LakeSampleCounts, by="Lake")
  ClassLakeCountsRnn$value <- c(ClassLakeCountsRnn$n.x/ClassLakeCountsRnn$n.y)
  ClassCountsT <- aggregate(ClassLakeCountsRnn$value, by=list(ClassLakeCountsRnn$Class), FUN = sum) #Chlorobia should be about 31.4389 if I calculated that right
  names(ClassCountsT)[names(ClassCountsT) == "x"] <- "ClassValue"
  names(ClassCountsT)[names(ClassCountsT) == "Group.1"] <- "Group"
  ClassCountsT$EETcount <- c(ENX)
  ClassCountsT$OTU.Proportion <- c(ClassCountsT$ClassValue/ave(ClassCountsT$ClassValue, ClassCountsT$EETcount, FUN = sum))
  
  ClassCountsX <- rbind(ClassCountsX,ClassCountsT)
}

ClassCountsX$EETcount <- factor(ClassCountsX$EETcount, levels = c("X",0:16))
ggplot(ClassCountsX, aes(x = EETcount, y = OTU.Proportion,fill=Group)) + geom_bar(stat='identity', color="black", size=.2) + theme(legend.position = "none") + geom_text(aes(label = Group), position = position_stack(vjust = .5),size = 2.5)
ggplot(ClassCountsX, aes(x = EETcount, y = OTU.Proportion,fill=Group)) + geom_bar(stat='identity', color="black", size=.2) + theme(legend.position = "none") + geom_text(aes(label = ifelse(OTU.Proportion > .005, Group, "")), position = position_stack(vjust = .5),size = 2.5)

#now I want to do the same except for only Dissimilar EET genes. (which are all the ones not even close to anything described)
#first rerun above line 69
#then run below
EetRange <- 0:12

for (ENX in EetRange) {
  ClassLakeCounts <- filter(TaxMetEet, dissimilar == ENX) %>% count(Lake, Class)
  ########################
  ClassLakeCountsR <- ClassLakeCounts
  for (val in Numbered) {
    ClassLakeCountsR$Class <- gsub(val, paste("",PhylumClassCounts[grep(val,PhylumClassCounts$Class), ][c(1)], sep = ""), ClassLakeCountsR$Class)
  }
  ClassLakeCountsRnn <- merge(ClassLakeCountsR, LakeSampleCounts, by="Lake")
  ClassLakeCountsRnn$value <- c(ClassLakeCountsRnn$n.x/ClassLakeCountsRnn$n.y)
  ClassCountsT <- aggregate(ClassLakeCountsRnn$value, by=list(ClassLakeCountsRnn$Class), FUN = sum) #Chlorobia should be about 31.4389 if I calculated that right
  names(ClassCountsT)[names(ClassCountsT) == "x"] <- "ClassValue"
  names(ClassCountsT)[names(ClassCountsT) == "Group.1"] <- "Group"
  ClassCountsT$EETcount <- c(ENX)
  ClassCountsT$OTU.Proportion <- c(ClassCountsT$ClassValue/ave(ClassCountsT$ClassValue, ClassCountsT$EETcount, FUN = sum))
  
  ClassCountsX <- rbind(ClassCountsX,ClassCountsT)
}

ClassCountsX$EETcount <- factor(ClassCountsX$EETcount, levels = c("X",0:12))
ggplot(ClassCountsX, aes(x = EETcount, y = OTU.Proportion,fill=Group)) + geom_bar(stat='identity', color="black", size=.2) + theme(legend.position = "none") + geom_text(aes(label = Group), position = position_stack(vjust = .5),size = 2.5)
ggplot(ClassCountsX, aes(x = EETcount, y = OTU.Proportion,fill=Group)) + geom_bar(stat='identity', color="black", size=.2) + theme(legend.position = "none") + geom_text(aes(label = ifelse(OTU.Proportion > .005, Group, "")), position = position_stack(vjust = .5),size = 2.5) + ylab("Proportion of OTUs") + xlab("Number of EET proteins")


#################################### Same Graphs but counted specific groups ####################################
# groups included: Gamma: to "other gamma" separate out Polynucleobacter , Limnohabitans, Rhodoferax 
# Alpha to "other Alpha" if I find charismatic Alpha




#which chlorobi have an EET gene 
chlorobi_withRespEET <- filter(filter(TaxMetEet, totalEET == "0"), Class == "Chlorobia" )
#Genes:DFE_0461, again, again, and so on, also found DFE_0448 a few times and DFE_0462 once (and all of them) in Ki2-D4_megahit_metabat_bin-0025

# Now to see whether EET ratio/OTU per lake is correlated with the ratio or number/OTU of other kinds of metabolism
# first I need to make some columns that represent the sums of various kinds of metabolisms.
TaxMetEetCombined <- TaxMetEet
TaxMetEetCombined <- mutate(TaxMetEetCombined, AnyKindResp = bcrC + bcrB + bcrA + bcrD + napA + napB + narG + narH + nrfH + nrfA + nrfD + nirB + nirD + nirK + nirS + octR + norB + norC + nosD + nosZ + hzoA + hzsA + dsrD + asrA + asrB + asrC + aprA + sat + sor + sreA + sreB + sreC + cld + pcrA + pcrB + pcpC + cprA + pceA + arsC1 + arsC2 + ygfM + xdhD + YgfK)
TaxMetEetCombined <- mutate(TaxMetEetCombined, InorganicOxid = coxS + coxM + coxL + amoA + amoB + amoC + nxrA + nxrB + fccB + sqr + sor + dsrA + dsrB + sdo + soxB + soxY + soxC + aoxA + aoxB)
#TaxMetEetCombined <- mutate(TaxMetEetCombined, InorganicOxid = aoxA + aoxB) # only arsenate
#TaxMetEetCombined <- mutate(TaxMetEetCombined, InorganicOxid = hzoA + hzsA) # only anammox
TaxMetEetCombined <- mutate(TaxMetEetCombined, C1Oxid = mxaF + mdh + pmoA + pmoB + pmoC + mmoB + mmoD)
TaxMetEetCombined <- mutate(TaxMetEetCombined, NitrogenResp = napA + napB + narG + narH + nrfH + nrfA + nrfD + nirB + nirD + nirK + nirS + octR + norB + norC + nosD + nosZ + hzoA + hzsA)
TaxMetEetCombined <- mutate(TaxMetEetCombined, NitrateResp = napA + napB + narG + narH)
TaxMetEetCombined <- mutate(TaxMetEetCombined, NitriteResp = nrfH + nrfA + nrfD + nirB + nirD + nirK + nirS + octR)
TaxMetEetCombined <- mutate(TaxMetEetCombined, SulfurAnyResp = dsrD + asrA + asrB + asrC + aprA + sat + sor + sreA + sreB + sreC)
TaxMetEetCombined <- mutate(TaxMetEetCombined, SulfateResp = aprA + sat)
TaxMetEetCombined <- mutate(TaxMetEetCombined, SulfurAnyOxid = fccB + sqr + sor + dsrA + dsrB + sdo + soxB + soxY + soxC)
TaxMetEetCombined <- mutate(TaxMetEetCombined, NitrogenOxid = amoA + amoB + amoC + nxrA + nxrB)
TaxMetEetCombined <- mutate(TaxMetEetCombined, MethaneProduction = mcrA	+ mcrB + mcrC)

TaxMetEetCombined <- mutate(TaxMetEetCombined, NitrRespNonMHC = narG + narH + nirB + nirD + nirK + nirS + nosD + nosZ + hzoA + hzsA)


#now to add presence absence for ratio quantifications: like in ifelse(temp$EETgenes > 0, 1, 0) ... I used vscode to pattern replace the above exactly
TaxMetEetCombined <- mutate(TaxMetEetCombined, AnyKindResp_PA = ifelse((bcrC + bcrB + bcrA + bcrD + napA + napB + narG + narH + nrfH + nrfA + nrfD + nirB + nirD + nirK + nirS + octR + norB + norC + nosD + nosZ + hzoA + hzsA + dsrD + asrA + asrB + asrC + aprA + sat + sor + sreA + sreB + sreC + cld + pcrA + pcrB + pcpC + cprA + pceA + arsC1 + arsC2 + ygfM + xdhD + YgfK) > 0, 1, 0))
TaxMetEetCombined <- mutate(TaxMetEetCombined, InorganicOxid_PA = ifelse((coxS + coxM + coxL + amoA + amoB + amoC + nxrA + nxrB + fccB + sqr + sor + dsrA + dsrB + sdo + soxB + soxY + soxC + aoxA + aoxB) > 0, 1, 0))
#TaxMetEetCombined <- mutate(TaxMetEetCombined, InorganicOxid_PA = ifelse((aoxA + aoxB) > 0, 1, 0)) #only arsenate
#TaxMetEetCombined <- mutate(TaxMetEetCombined, InorganicOxid_PA = ifelse((hzoA + hzsA) > 0, 1, 0)) #only Anammox
TaxMetEetCombined <- mutate(TaxMetEetCombined, C1Oxid_PA = ifelse((mxaF + mdh + pmoA + pmoB + pmoC + mmoB + mmoD) > 0, 1, 0))
TaxMetEetCombined <- mutate(TaxMetEetCombined, NitrogenResp_PA = ifelse((napA + napB + narG + narH + nrfH + nrfA + nrfD + nirB + nirD + nirK + nirS + octR + norB + norC + nosD + nosZ + hzoA + hzsA) > 0, 1, 0))
TaxMetEetCombined <- mutate(TaxMetEetCombined, NitrateResp_PA = ifelse((napA + napB + narG + narH) > 0, 1, 0))
TaxMetEetCombined <- mutate(TaxMetEetCombined, NitriteResp_PA = ifelse((nrfH + nrfA + nrfD + nirB + nirD + nirK + nirS + octR) > 0, 1, 0))
TaxMetEetCombined <- mutate(TaxMetEetCombined, SulfurAnyResp_PA = ifelse((dsrD + asrA + asrB + asrC + aprA + sat + sor + sreA + sreB + sreC) > 0, 1, 0))
TaxMetEetCombined <- mutate(TaxMetEetCombined, SulfateResp_PA = ifelse((aprA + sat) > 0, 1, 0))
TaxMetEetCombined <- mutate(TaxMetEetCombined, SulfurAnyOxid_PA = ifelse((fccB + sqr + sor + dsrA + dsrB + sdo + soxB + soxY + soxC) > 0, 1, 0))
TaxMetEetCombined <- mutate(TaxMetEetCombined, NitrogenOxid_PA = ifelse((amoA + amoB + amoC + nxrA + nxrB) > 0, 1, 0))
TaxMetEetCombined <- mutate(TaxMetEetCombined, totalEET_PA  = ifelse(totalEET > 0, 1, 0))
TaxMetEetCombined <- mutate(TaxMetEetCombined, RespEET_PA  = ifelse(RespEET > 0, 1, 0))
TaxMetEetCombined <- mutate(TaxMetEetCombined, OxidEET_PA  = ifelse(OxidEET > 0, 1, 0))
TaxMetEetCombined <- mutate(TaxMetEetCombined, undescribed_PA  = ifelse(undescribed > 0, 1, 0))
TaxMetEetCombined <- mutate(TaxMetEetCombined, MethaneProduction_PA = ifelse((mcrA	+ mcrB + mcrC) > 0, 1, 0))

TaxMetEetCombined <- mutate(TaxMetEetCombined, NitrMHC_PA  = ifelse(dissimilar > 0, 1, 0))
TaxMetEetCombined <- mutate(TaxMetEetCombined, dissimilar_PA  = ifelse(dissimilar > 0, 1, 0))
TaxMetEetCombined <- mutate(TaxMetEetCombined, Resp80_PA  = ifelse(Resp80 > 0, 1, 0))
TaxMetEetCombined <- mutate(TaxMetEetCombined, RespNoN_PA  = ifelse(RespNoN > 0, 1, 0))
TaxMetEetCombined <- mutate(TaxMetEetCombined, NitrRespNonMHC_PA = ifelse((narG + narH + nirB + nirD + nirK + nirS + nosD + nosZ + hzoA + hzsA) > 0, 1, 0))


#make it so none of the rows not being grouped are non-numbers
TaxMetEetCombOnly <- TaxMetEetCombined[c(1,224:264)]
TaxMetEetCombWbin <- TaxMetEetCombined[c(1,2,224:264)]
SampTaxMetEet <- TaxMetEetCombOnly %>% group_by(Sample,Lake) %>% summarise_all(funs(sum, length))

#if I want to make sure that there is not multiples of an organism per lake, I can left join TaxMetEetCombWbin onto the ByLake, then grep the remaining 1-sample lakes' bins like trout bog
ByLakeBinEET <- ByLake[c(3,4)]
MetEetFilt <- left_join(ByLakeBinEET, TaxMetEetCombWbin, by=c("bin"="user_genome"))
MetEetFilt <- MetEetFilt[c(1,3:44)] #EET total values look all the same, getting rid of orig
#grabbing missing bins and putting dataframe into right format
MissingSamp <- filter(TaxMetEetCombWbin, grepl('TroutBog_epilimnion_OSF|TroutBog_hypolimnion_OSF|Crystal_Bog_OSF|Mary_Lake_OSF', Sample))
MissingSamp <- MissingSamp[c(2,1,3:43)]
names(MissingSamp)[names(MissingSamp) == "user_genome"] <- "bin"
MetEetFilt <- rbind(MetEetFilt,MissingSamp)

#summing by lake
MetEetFiltNbin <- MetEetFilt[c(3:43)]
SampTaxMetEetFilt <- MetEetFiltNbin %>% group_by(Lake) %>% summarise_all(funs(sum, length))
SampTaxMetEetFilt <- SampTaxMetEetFilt[c(1:42)] #don't need more than one length
names(SampTaxMetEetFilt)[names(SampTaxMetEetFilt) == "totalEET_length"] <- "BinCount"
SampTaxMetEetFilt <- SampTaxMetEetFilt[ c(1:38),] #extra row removed

#next sum lake ratios... these really should be called LakeMETEetRatios instead of SampMETEetRatios... ooops, if I want to do sample specific I'll have to go back to before filtering
SampMETEetRatios <- SampTaxMetEetFilt
SampMETEetRatios$totalEETRatio <- c(SampMETEetRatios$totalEET_PA_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$totalEETOTU <- c(SampMETEetRatios$totalEET_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$RespEETRatio <- c(SampMETEetRatios$RespEET_PA_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$RespEETOTU <- c(SampMETEetRatios$RespEET_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$OxidEETRatio <- c(SampMETEetRatios$OxidEET_PA_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$OxidEETOTU <- c(SampMETEetRatios$OxidEET_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$undescribedEETRatio <- c(SampMETEetRatios$undescribed_PA_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$undescribedEETOTU <- c(SampMETEetRatios$undescribed_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$NitrogenOxidRatio <- c(SampMETEetRatios$NitrogenOxid_PA_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$NitrogenOxidOTU <- c(SampMETEetRatios$NitrogenOxid_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$C1OxidRatio <- c(SampMETEetRatios$C1Oxid_PA_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$C1OxidOTU <- c(SampMETEetRatios$C1Oxid_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$InorganicOxidRatio <- c(SampMETEetRatios$InorganicOxid_PA_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$InorganicOxidOTU <- c(SampMETEetRatios$InorganicOxid_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$AnyKindRespRatio <- c(SampMETEetRatios$AnyKindResp_PA_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$AnyKindRespOTU <- c(SampMETEetRatios$AnyKindResp_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$NitrogenRespRatio <- c(SampMETEetRatios$NitrogenResp_PA_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$NitrogenRespOTU <- c(SampMETEetRatios$NitrogenResp_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$NitrateRespRatio <- c(SampMETEetRatios$NitrateResp_PA_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$NitrateRespOTU <- c(SampMETEetRatios$NitrateResp_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$NitriteRespRatio <- c(SampMETEetRatios$NitriteResp_PA_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$NitriteRespOTU <- c(SampMETEetRatios$NitriteResp_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$SulfurAnyRespRatio <- c(SampMETEetRatios$SulfurAnyResp_PA_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$SulfurAnyRespOTU <- c(SampMETEetRatios$SulfurAnyResp_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$SulfateRespRatio <- c(SampMETEetRatios$SulfateResp_PA_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$SulfateRespOTU <- c(SampMETEetRatios$SulfateResp_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$SulfurAnyOxidRatio <- c(SampMETEetRatios$SulfurAnyOxid_PA_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$SulfurAnyOxidOTU <- c(SampMETEetRatios$SulfurAnyOxid_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$MethaneProductionRatio <- c(SampMETEetRatios$MethaneProduction_PA_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$MethaneProductionOTU <- c(SampMETEetRatios$MethaneProduction_sum/SampMETEetRatios$BinCount)

SampMETEetRatios$dissimilarEETRatio <- c(SampMETEetRatios$dissimilar_PA_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$dissimilarEETOTU <- c(SampMETEetRatios$dissimilar_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$Resp80EETRatio <- c(SampMETEetRatios$Resp80_PA_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$Resp80EETOTU <- c(SampMETEetRatios$Resp80_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$RespNoNEETRatio <- c(SampMETEetRatios$RespNoN_PA_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$RespNoNEETOTU <- c(SampMETEetRatios$RespNoN_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$NitrMHCEETRatio <- c(SampMETEetRatios$NitrMHC_PA_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$NitrMHCEETOTU <- c(SampMETEetRatios$NitrMHC_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$NitrRespNonMHCRatio <- c(SampMETEetRatios$NitrRespNonMHC_PA_sum/SampMETEetRatios$BinCount)
SampMETEetRatios$NitrRespNonMHCOTU <- c(SampMETEetRatios$NitrRespNonMHC_sum/SampMETEetRatios$BinCount)

colnames(TaxMetEetCombined)

#then calculate error bars using sample variation before filtering
colnames(SampTaxMetEet)
SampTaxMetEet <- SampTaxMetEet[c(1:43)] #only need one length
names(SampTaxMetEet)[names(SampTaxMetEet) == "totalEET_length"] <- "BinCount"
#it involves the same long code above but swapped out SampMETEetRatios with SampTaxMetEet
SampTaxMetEet$totalEETRatio <- c(SampTaxMetEet$totalEET_PA_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$totalEETOTU <- c(SampTaxMetEet$totalEET_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$RespEETRatio <- c(SampTaxMetEet$RespEET_PA_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$RespEETOTU <- c(SampTaxMetEet$RespEET_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$OxidEETRatio <- c(SampTaxMetEet$OxidEET_PA_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$OxidEETOTU <- c(SampTaxMetEet$OxidEET_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$undescribedEETRatio <- c(SampTaxMetEet$undescribed_PA_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$undescribedEETOTU <- c(SampTaxMetEet$undescribed_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$NitrogenOxidRatio <- c(SampTaxMetEet$NitrogenOxid_PA_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$NitrogenOxidOTU <- c(SampTaxMetEet$NitrogenOxid_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$C1OxidRatio <- c(SampTaxMetEet$C1Oxid_PA_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$C1OxidOTU <- c(SampTaxMetEet$C1Oxid_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$InorganicOxidRatio <- c(SampTaxMetEet$InorganicOxid_PA_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$InorganicOxidOTU <- c(SampTaxMetEet$InorganicOxid_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$AnyKindRespRatio <- c(SampTaxMetEet$AnyKindResp_PA_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$AnyKindRespOTU <- c(SampTaxMetEet$AnyKindResp_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$NitrogenRespRatio <- c(SampTaxMetEet$NitrogenResp_PA_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$NitrogenRespOTU <- c(SampTaxMetEet$NitrogenResp_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$NitrateRespRatio <- c(SampTaxMetEet$NitrateResp_PA_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$NitrateRespOTU <- c(SampTaxMetEet$NitrateResp_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$NitriteRespRatio <- c(SampTaxMetEet$NitriteResp_PA_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$NitriteRespOTU <- c(SampTaxMetEet$NitriteResp_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$SulfurAnyRespRatio <- c(SampTaxMetEet$SulfurAnyResp_PA_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$SulfurAnyRespOTU <- c(SampTaxMetEet$SulfurAnyResp_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$SulfateRespRatio <- c(SampTaxMetEet$SulfateResp_PA_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$SulfateRespOTU <- c(SampTaxMetEet$SulfateResp_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$SulfurAnyOxidRatio <- c(SampTaxMetEet$SulfurAnyOxid_PA_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$SulfurAnyOxidOTU <- c(SampTaxMetEet$SulfurAnyOxid_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$MethaneProductionRatio <- c(SampTaxMetEet$MethaneProduction_PA_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$MethaneProductionOTU <- c(SampTaxMetEet$MethaneProduction_sum/SampTaxMetEet$BinCount)

SampTaxMetEet$dissimilarEETRatio <- c(SampTaxMetEet$dissimilar_PA_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$dissimilarEETOTU <- c(SampTaxMetEet$dissimilar_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$Resp80EETRatio <- c(SampTaxMetEet$Resp80_PA_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$Resp80EETOTU <- c(SampTaxMetEet$Resp80_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$RespNoNEETRatio <- c(SampTaxMetEet$RespNoN_PA_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$RespNoNEETOTU <- c(SampTaxMetEet$RespNoN_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$NitrMHCEETRatio <- c(SampTaxMetEet$NitrMHC_PA_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$NitrMHCEETOTU <- c(SampTaxMetEet$NitrMHC_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$NitrRespNonMHCRatio <- c(SampTaxMetEet$NitrRespNonMHC_PA_sum/SampTaxMetEet$BinCount)
SampTaxMetEet$NitrRespNonMHCOTU <- c(SampTaxMetEet$NitrRespNonMHC_sum/SampTaxMetEet$BinCount)

#now to get error bars
colnames(SampTaxMetEet)
SampTaxMetEetUnft <- SampTaxMetEet[c(2:83)]
UnfiltStErr <- SampTaxMetEetUnft %>% group_by(Lake) %>% summarise_all(funs(mean,sd))
colnames(UnfiltStErr)
UnfiltStErr <- UnfiltStErr[c(1,83:163)]

#then combine with environmental data, then calculate n,r,p values and graph sometimes
MetEetFilt <- left_join(ByLakeBinEET, TaxMetEetCombWbin, by=c("bin"="user_genome"))
LakeMETEetRatios <- left_join(SampMETEetRatios, UnfiltStErr, by=c("Lake"="Lake"))
#Now i can graph with that.
#removing F5 outlier #AND now removing big lake Erken
LakeMETEetRatios_OLR <- LakeMETEetRatios[ c(1:10,13:38),]
#adding in the environmental data
LakeMETEetRatios_OLR <- left_join(LakeMETEetRatios_OLR, Totals_L, by=c("Lake"="Lake"))
colnames(LakeMETEetRatios_OLR)
#Mary Lake total iron = .775mg/L, at least in 1973 (epilimnion/mixicline ave with hypo)
# = (.775mg/L)(1g/1000mg)(1M // 55g/L)(1^6uM/1M) = XuM = 14uM 
#Trout = .45mg/L = ~8uM
#data.frame[row_number, column_number] = new_value
LakeMETEetRatios_OLR["22","FeTot"] <- 14
#But first I'll make a bunch of r, p, n values for a heatmap 
#colnames(data)[colnames(data) == "Old_Name"] <- "New_Name"
colnames(LakeMETEetRatios_OLR)[colnames(LakeMETEetRatios_OLR) == "NitrRespNonMHCEETOTU"] <- "NitrRespNonMHCOTU"
colnames(LakeMETEetRatios_OLR)[colnames(LakeMETEetRatios_OLR) == "NitrRespNonMHCEETRatio"] <- "NitrRespNonMHCRatio"
colnames(LakeMETEetRatios_OLR)[colnames(LakeMETEetRatios_OLR) == "NitrRespNonMHCEETRatio_sd"] <- "NitrRespNonMHCRatio_sd"
colnames(LakeMETEetRatios_OLR)[colnames(LakeMETEetRatios_OLR) == "NitrRespNonMHCEETOTU_sd"] <- "NitrRespNonMHCOTU_sd"

#Ratios
METHeatmap <- data.frame(This=character(), withThis=character(), By=character(),N=numeric(), r=numeric(), p=numeric(), stringsAsFactors=FALSE) # Blank DF

#EETRatios vs eachother 
METHeatmap[nrow(METHeatmap) + 1,] = c("totalEETRatio","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$totalEETRatio, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$totalEETRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$totalEETRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("totalEETRatio","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$totalEETRatio, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$totalEETRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$totalEETRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("totalEETRatio","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$dissimilarEETRatio, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$dissimilarEETRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$dissimilarEETRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("RespEETRatio","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$dissimilarEETRatio, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$dissimilarEETRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$dissimilarEETRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("RespEETRatio","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$RespEETRatio, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$RespEETRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$RespEETRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("OxidEETRatio","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$dissimilarEETRatio, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$dissimilarEETRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$dissimilarEETRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#EETOTUs vs eachother 
METHeatmap[nrow(METHeatmap) + 1,] = c("totalEETOTU","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$totalEETOTU, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$totalEETOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$totalEETOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("totalEETOTU","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$totalEETOTU, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$totalEETOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$totalEETOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("totalEETOTU","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$dissimilarEETOTU, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$dissimilarEETOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$dissimilarEETOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("RespEETOTU","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$dissimilarEETOTU, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$dissimilarEETOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$dissimilarEETOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("RespEETOTU","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$RespEETOTU, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$RespEETOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$RespEETOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("OxidEETOTU","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$dissimilarEETOTU, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$dissimilarEETOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$dissimilarEETOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#Mixed
METHeatmap[nrow(METHeatmap) + 1,] = c("totalEETRatio","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$totalEETRatio, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$totalEETRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$totalEETRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("totalEETRatio","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$totalEETRatio, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$totalEETRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$totalEETRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("totalEETRatio","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$dissimilarEETOTU, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$dissimilarEETOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$dissimilarEETOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("RespEETRatio","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$dissimilarEETOTU, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$dissimilarEETOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$dissimilarEETOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("RespEETRatio","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$RespEETRatio, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$RespEETRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$RespEETRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("OxidEETOTU","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$dissimilarEETRatio, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$dissimilarEETRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$dissimilarEETRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#reverse mixed
METHeatmap[nrow(METHeatmap) + 1,] = c("totalEETOTU","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$totalEETOTU, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$totalEETOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$totalEETOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("totalEETOTU","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$totalEETOTU, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$totalEETOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$totalEETOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("totalEETOTU","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$dissimilarEETRatio, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$dissimilarEETRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$dissimilarEETRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("RespEETOTU","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$dissimilarEETRatio, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$dissimilarEETRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$dissimilarEETRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("RespEETOTU","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$RespEETOTU, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$RespEETOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$RespEETOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("OxidEETRatio","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$dissimilarEETOTU, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$dissimilarEETOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$dissimilarEETOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#Stragglers
METHeatmap[nrow(METHeatmap) + 1,] = c("totalEETRatio","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$totalEETRatio, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$totalEETRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$totalEETRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("OxidEETRatio","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$OxidEETRatio, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$OxidEETRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$OxidEETRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("RespEETRatio","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$RespEETRatio, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$RespEETRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$RespEETRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("dissimilarEETRatio","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$dissimilarEETRatio, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$dissimilarEETRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$dissimilarEETRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)

#heatmap EET ratios vs themselves
b <- c(-1, 0, 1)
x <- METHeatmap$This
y <- METHeatmap$withThis
r <- as.numeric(METHeatmap$r)
p <- as.numeric(METHeatmap$p)
N <- as.numeric(METHeatmap$N)
data <- data.frame(x,y,r,p) 
ggplot(data, aes(x, y)) + 
  geom_tile(aes(fill = r)) + 
  geom_text(aes(label = paste(str_remove(as.character(sprintf("%.3f",p)), "^0+"),"(",N,")")), color = ifelse(p <= 0.05 & N >= 5,'yellow1','black'),size = 5) +
  scale_fill_gradient2(limits = c(-1,1),low="red", high="dodgerblue", mid="white", breaks=b, labels=format(b)) + 
  theme(axis.title.x=element_blank(), axis.title.y=element_blank(),
        legend.justification = c(1, 0),
        legend.position = c(.64, 0.72),
        legend.direction = "horizontal") +
  theme(axis.text.x=element_text(angle = -20, hjust = 0)) +
  theme(plot.margin = unit(c(1, 5, .5, 1), "cm")) +
  guides(fill = guide_colorbar(barwidth = 26, barheight = 4, title.position = "top", title.hjust = 0.5))


#Messing with colors, bold, and labels

ggplot(data, aes(x, y)) + 
  geom_tile(aes(fill = r), color = "white",lwd=.5) +
  scale_y_discrete("y", labels = c("dissimilarEETRatio"="NovelEETRatio","dissimilarEETOTU"="NovelEET/OTU","totalEETOTU"="TotalEET/OTU","totalEETRatio"="TotalEETRatio","RespEETOTU"="RedEET/OTU","OxidEETOTU"="OxiEET/OTU","RespEETRatio"="RedEETRatio","OxidEETRatio"="OxiEETRatio")) +
  scale_x_discrete("x", labels = c("dissimilarEETRatio"="NovelEETRatio","dissimilarEETOTU"="NovelEET/OTU","totalEETOTU"="TotalEET/OTU","totalEETRatio"="TotalEETRatio","RespEETOTU"="RedEET/OTU","OxidEETOTU"="OxiEET/OTU","RespEETRatio"="RedEETRatio","OxidEETRatio"="OxiEETRatio")) +
  geom_text(aes(label = paste(str_remove(as.character(sprintf("%.3f",p)), "^0+"),"(",N,")")), fontface = "bold", color = ifelse(p <= 0.05 & N >= 5,'yellow1','white'),size = 5) +
  scale_fill_gradient2(limits = c(-1,1),low="red", high="dodgerblue", mid="black", breaks=b, labels=format(b)) + 
  theme(axis.title.x=element_blank(), axis.title.y=element_blank(),
        legend.justification = c(1, 0),
        legend.position = c(.64, 0.72),
        legend.direction = "horizontal") +
  theme(axis.text.x=element_text(angle = -20, hjust = 0)) +
  theme(plot.margin = unit(c(1, 5, .5, 1), "cm")) +
  guides(fill = guide_colorbar(barwidth = 26, barheight = 4, title.position = "top", title.hjust = 0.5))


#reset
METHeatmap <- data.frame(This=character(), withThis=character(), By=character(),N=numeric(), r=numeric(), p=numeric(), stringsAsFactors=FALSE) # Blank DF

#EETRatios vs Environmental
METHeatmap[nrow(METHeatmap) + 1,] = c("Temperature","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("Temperature","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("Temperature","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("Temperature","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SO4","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SO4","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SO4","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SO4","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("PO4","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("PO4","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("PO4","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("PO4","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("pH","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("pH","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("pH","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("pH","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("ODO","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("ODO","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("ODO","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("ODO","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NOX","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NOX","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NOX","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NOX","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NO3","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NO3","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NO3","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NO3","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NO2","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NO2","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NO2","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NO2","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("FeTot","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("FeTot","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("FeTot","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("FeTot","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("DOC","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("DOC","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("DOC","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("DOC","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("Depth","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("Depth","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("Depth","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("Depth","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("CO2","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("CO2","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("CO2","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("CO2","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("CH4","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("CH4","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("CH4","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("CH4","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)

#EETOTUs vs Environmental
METHeatmap[nrow(METHeatmap) + 1,] = c("Temperature","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("Temperature","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("Temperature","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("Temperature","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SO4","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SO4","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SO4","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SO4","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("PO4","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("PO4","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("PO4","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("PO4","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("pH","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("pH","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("pH","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("pH","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("ODO","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("ODO","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("ODO","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("ODO","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NOX","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NOX","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NOX","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NOX","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NO3","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NO3","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NO3","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NO3","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NO2","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NO2","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NO2","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NO2","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("FeTot","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("FeTot","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("FeTot","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("FeTot","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("DOC","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("DOC","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("DOC","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("DOC","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("Depth","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("Depth","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("Depth","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("Depth","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("CO2","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("CO2","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("CO2","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("CO2","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("CH4","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("CH4","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("CH4","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("CH4","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)

# adding 'dissimilar' 'Resp80' 'RespNoN' 'NitrMHC'
METHeatmap[nrow(METHeatmap) + 1,] = c("Temperature","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SO4","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("PO4","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("pH","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("ODO","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NOX","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NO3","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NO2","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("FeTot","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("DOC","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("Depth","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("CO2","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("CH4","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("Temperature","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SO4","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("PO4","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("pH","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("ODO","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NOX","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NO3","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NO2","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("FeTot","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("DOC","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("Depth","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("CO2","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("CH4","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("Temperature","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SO4","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("PO4","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("pH","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("ODO","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NOX","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NO3","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NO2","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("FeTot","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("DOC","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("Depth","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("CO2","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("CH4","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("Temperature","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SO4","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("PO4","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("pH","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("ODO","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NOX","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NO3","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NO2","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("FeTot","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("DOC","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("Depth","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("CO2","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("CH4","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("Temperature","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SO4","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("PO4","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("pH","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("ODO","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NOX","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NO3","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NO2","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("FeTot","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("DOC","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("Depth","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("CO2","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("CH4","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("Temperature","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SO4","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("PO4","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("pH","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("ODO","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NOX","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NO3","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NO2","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("FeTot","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("DOC","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("Depth","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("CO2","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("CH4","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("Temperature","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SO4","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("PO4","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("pH","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("ODO","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NOX","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NO3","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NO2","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("FeTot","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("DOC","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("Depth","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("CO2","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("CH4","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("Temperature","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SO4","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("PO4","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$PO4, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("pH","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("ODO","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NOX","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NOX, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NO3","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO3, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NO2","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NO2, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("FeTot","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("DOC","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("Depth","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$Depth, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("CO2","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CO2, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("CH4","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$CH4, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)


#Heatmap for EETRatio and EETotu vs Environmental 
b <- c(-1, 0, 1)
x <- METHeatmap$This
y <- METHeatmap$withThis
r <- as.numeric(METHeatmap$r)
p <- as.numeric(METHeatmap$p) # p <- METHeatmap$p %>% p.adjust(method = "BH")
BH <- METHeatmap$p %>% p.adjust(method = "BH")
N <- as.numeric(METHeatmap$N)
data <- data.frame(x,y,r,p,BH) 
ggplot(data, aes(x, y)) + 
  geom_tile(aes(fill = r)) + 
  geom_text(aes(label = paste(str_remove(as.character(sprintf("%.3f",p)), "^0+"),"(",N,")")), color = ifelse(BH <= 0.05 & N >= 5,'yellow1','black'),size = 3.5) +
  scale_fill_gradient2(limits = c(-1,1),low="red", high="dodgerblue", mid="white", breaks=b, labels=format(b)) + 
  theme(axis.title.x=element_blank(), axis.title.y=element_blank(),
        legend.justification = c(1, 0),
        legend.position = c(1.06, 0.3),
        legend.direction = "vertical") +
  theme(axis.text.x=element_text(angle = -20, hjust = 0)) +
  theme(plot.margin = unit(c(1, 5, .5, 1), "cm")) +
  guides(fill = guide_colorbar(barwidth = 2, barheight = 15, title.position = "top", title.hjust = 0.22))

#Messing with colors, bold, and labels
ggplot(data, aes(x, y)) + 
  geom_tile(aes(fill = r), color = "white",lwd=0) + 
  scale_y_discrete("y", labels = c("dissimilarEETRatio"="NovelEETRatio","dissimilarEETOTU"="NovelEET/OTU","totalEETOTU"="TotalEET/OTU","totalEETRatio"="TotalEETRatio","RespNoNEETOTU"="RedNoNEET/OTU","OxidEETOTU"="OxiEET/OTU","NitrMHCEETOTU"="NitrMHCEET/OTU","RespNoNEETRatio"="RedNoNEETRatio","OxidEETRatio"="OxiEETRatio","RespEETRatio"="RedEETRatio")) +
  scale_x_discrete("x", labels = c("CH4"=expression(CH[4]),"CO2"=expression(CO[2]),"NO3"=expression(NO[3]),"PO4"=expression(PO[4]),"SO4"=expression(SO[4]))) +
  geom_text(aes(label = paste(str_remove(as.character(sprintf("%.3f",p)), "^0+"),"(",N,")")), fontface = "bold", color = ifelse(BH <= 0.05 & N >= 5,'yellow','white'),size = 3.5) +
  scale_fill_gradient2(limits = c(-1,1),low="red", high="dodgerblue", mid="black", breaks=b, labels=format(b)) + 
  theme(axis.title.x=element_blank(), axis.title.y=element_blank(),
        legend.justification = c(1, 0),
        legend.position = c(1.08, 0.13),
        legend.direction = "vertical") +
  theme(axis.text.x=element_text(angle = -20, hjust = 0)) +
  theme(plot.margin = unit(c(1, 5, .5, 1), "cm")) +
  guides(fill = guide_colorbar(barwidth = 2, barheight = 15, title.position = "top", title.hjust = 0.22))


#reset
METHeatmap <- data.frame(This=character(), withThis=character(), By=character(),N=numeric(), r=numeric(), p=numeric(), stringsAsFactors=FALSE) # Blank DF

#EETRatios vs METABOLIC 
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
#reverse
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)

#EETOTUs vs METABOLIC 
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
#reverse
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)

# adding 'dissimilar' 'Resp80' 'RespNoN' 'NitrMHC' and 'NitrRespNonMHC'
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","OxidEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$OxidEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$OxidEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","RespEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$RespEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$RespEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","undescribedEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$undescribedEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$undescribedEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","totalEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$totalEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$totalEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","OxidEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$OxidEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$OxidEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","RespEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$RespEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$RespEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","undescribedEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$undescribedEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$undescribedEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","totalEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$totalEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$totalEETRatio, use = "complete.obs")$p.value)

METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)

METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","dissimilarEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$dissimilarEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$dissimilarEETOTU, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","Resp80EETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$Resp80EETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$Resp80EETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","RespNoNEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$RespNoNEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$RespNoNEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","NitrMHCEETOTU","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$NitrMHCEETOTU, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","dissimilarEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$dissimilarEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$dissimilarEETRatio, use = "complete.obs")$p.value)
#METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","Resp80EETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$Resp80EETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$Resp80EETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","RespNoNEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$RespNoNEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$RespNoNEETRatio, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","NitrMHCEETRatio","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$NitrMHCEETRatio, use = "complete.obs")$p.value)


#Heatmap for Metabolic vs EET
b <- c(-1, 0, 1)
x <- METHeatmap$This
y <- METHeatmap$withThis
r <- as.numeric(METHeatmap$r)
p <- as.numeric(METHeatmap$p) # p <- METHeatmap$p %>% p.adjust(method = "BH")
BH <- METHeatmap$p %>% p.adjust(method = "BH")
N <- as.numeric(METHeatmap$N)
data <- data.frame(x,y,r,p,BH) 
ggplot(data, aes(x, y)) + 
  geom_tile(aes(fill = r)) + 
  geom_text(aes(label = paste(str_remove(as.character(sprintf("%.3f",p)), "^0+"),"(",N,")")), color = ifelse(BH <= 0.05 & N >= 5,'yellow1','black'),size = 2.2) +
  scale_fill_gradient2(limits = c(-1,1),low="red", high="dodgerblue", mid="white", breaks=b, labels=format(b)) + 
  theme(axis.title.x=element_blank(), axis.title.y=element_blank(),
        legend.justification = c(1, 0),
        legend.position = c(1.06, 0.3),
        legend.direction = "vertical") +
  theme(axis.text.x=element_text(angle = -20, hjust = 0)) +
  theme(plot.margin = unit(c(1, 5, .5, 1), "cm")) +
  guides(fill = guide_colorbar(barwidth = 2, barheight = 15, title.position = "top", title.hjust = 0.22))

#Messing with colors, bold, and labels
ggplot(data, aes(x, y)) + 
  geom_tile(aes(fill = r), color = "white",lwd=.25) + 
  scale_y_discrete("y", labels = c("dissimilarEETRatio"="NovelEETRatio","dissimilarEETOTU"="NovelEET/OTU","totalEETOTU"="TotalEET/OTU","totalEETRatio"="TotalEETRatio","RespNoNEETOTU"="RedNoNEET/OTU","RespNoNEETRatio"="RedNoNEETRatio","OxidEETOTU"="OxiEET/OTU","OxidEETRatio"="OxiEETRatio","NitrMHCEETOTU"="NitrMHCEET/OTU")) +
  scale_x_discrete("x", labels = c("AnyKindRespOTU"="AnyKindRed/OTU","AnyKindRespRatio"="AnyKindRedRatio","C1OxidOTU"="C1Oxi/OTU","C1OxidRatio"="C1OxiRatio","InorganicOxidOTU"="InorganicOxi/OTU","InorganicOxidRatio"="InorganicOxiRatio","MethaneProductionOTU"="MethaneProduction/OTU","NitrateRespOTU"="NitrateRed/OTU","NitrateRespRatio"="NitrateRedRatio","NitriteRespOTU"="NitriteRed/OTU","NitriteRespRatio"="NitriteRedRatio","NitrogenOxidOTU"="NitrogenOxi/OTU","NitrogenOxidRatio"="NitrogenOxiRatio","NitrRespNonMHCOTU"="NitrRedNonMHC/OTU","NitrRespNonMHCRatio"="NitrRedNonMHCRatio","SulfateRespOTU"="SulfateRed/OTU","SulfateRespRatio"="SulfateRedRatio","SulfurAnyOxidOTU"="SulfurAnyOxi/OTU","SulfurAnyOxidRatio"="SulfurAnyOxiRatio","SulfurAnyRespOTU"="SulfurAnyRed/OTU","SulfurAnyRespRatio"="SulfurAnyRedRatio","NitrogenRespOTU"="NitrogenRed/OTU","NitrogenRespRatio"="NitrogenRedRatio")) +
  geom_text(aes(label = paste(str_remove(as.character(sprintf("%.3f",p)), "^0+"),"(",N,")")), fontface = "bold", color = ifelse(BH <= 0.05 & N >= 5,'yellow1','white'),size = 2.2) +
  scale_fill_gradient2(limits = c(-1,1),low="red", high="dodgerblue", mid="black", breaks=b, labels=format(b)) + 
  theme(axis.title.x=element_blank(), axis.title.y=element_blank(),
        legend.justification = c(1, 0),
        legend.position = c(1.06, 0.02),
        legend.direction = "vertical") +
  theme(axis.text.x=element_text(angle = -20, hjust = 0)) +
  theme(plot.margin = unit(c(1, 5, .5, 1), "cm")) +
  guides(fill = guide_colorbar(barwidth = 2, barheight = 12, title.position = "top", title.hjust = 0.22))

#reset
METHeatmap <- data.frame(This=character(), withThis=character(), By=character(),N=numeric(), r=numeric(), p=numeric(), stringsAsFactors=FALSE) # Blank DF

#METABOLIC ratios vs Environmental 
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidRatio","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidRatio","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidRatio","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespRatio","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespRatio","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespRatio","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespRatio","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespRatio","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespRatio","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidRatio","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionRatio","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
#METABOLIC OTU vs Environmental 
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenOxidOTU","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenOxidOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("C1OxidOTU","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$C1OxidOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("InorganicOxidOTU","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$InorganicOxidOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("AnyKindRespOTU","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$AnyKindRespOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrogenRespOTU","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrogenRespOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrateRespOTU","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrateRespOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitriteRespOTU","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitriteRespOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyRespOTU","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyRespOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfateRespOTU","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfateRespOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("SulfurAnyOxidOTU","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$SulfurAnyOxidOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("MethaneProductionOTU","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$MethaneProductionOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
#just adding 'NitrRespNonMHC' 
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCRatio","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCRatio, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","Temperature","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$Temperature), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$Temperature, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$SO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","PO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$PO4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$PO4, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$pH), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$ODO), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","NOX","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$NOX), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$NOX, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","NO3","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$NO3), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$NO3, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","NO2","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$NO2), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$NO2, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$DOC), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","Depth","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$Depth), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$Depth, use = "complete.obs")$p.value)
METHeatmap[nrow(METHeatmap) + 1,] = c("NitrRespNonMHCOTU","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$CH4), na.rm = TRUE), cor(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs"), cor.test(LakeMETEetRatios_OLR$NitrRespNonMHCOTU, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value)

#Heatmap for METABOLIC vs Environmental (both giant columns above)
b <- c(-1, 0, 1)
x <- METHeatmap$This
y <- METHeatmap$withThis

r <- as.numeric(METHeatmap$r)
p <- as.numeric(METHeatmap$p) # p <- METHeatmap$p %>% p.adjust(method = "BH")
BH <- METHeatmap$p %>% p.adjust(method = "BH")
N <- as.numeric(METHeatmap$N)

data <- data.frame(x,y,r,p,BH) 

ggplot(data, aes(x, y)) + 
  geom_tile(aes(fill = r)) + 
  geom_text(aes(label = paste(str_remove(as.character(sprintf("%.3f",p)), "^0+"),"(",N,")")), color = ifelse(BH <= 0.05 & N >= 5,'yellow1','black'),size = 2.5) +
  scale_fill_gradient2(limits = c(-1,1),low="red", high="dodgerblue", mid="white", breaks=b, labels=format(b)) + 
  theme(axis.title.x=element_blank(), axis.title.y=element_blank(),
        legend.justification = c(1, 0),
        legend.position = c(1.06, 0.3),
        legend.direction = "vertical") +
  theme(axis.text.x=element_text(angle = -20, hjust = 0)) +
  theme(plot.margin = unit(c(1, 5, .5, 1), "cm")) +
  guides(fill = guide_colorbar(barwidth = 2, barheight = 15, title.position = "top", title.hjust = 0.22))

#Messing with colors, bold, and labels
ggplot(data, aes(x, y)) + 
  geom_tile(aes(fill = r), color = "white",lwd=.25) + 
  scale_x_discrete("x", labels = c("AnyKindRespOTU"="AnyKindRed/OTU","AnyKindRespRatio"="AnyKindRedRatio","C1OxidOTU"="C1Oxi/OTU","C1OxidRatio"="C1OxiRatio","InorganicOxidOTU"="InorganicOxi/OTU","InorganicOxidRatio"="InorganicOxiRatio","MethaneProductionOTU"="MethaneProduction/OTU","NitrateRespOTU"="NitrateRed/OTU","NitrateRespRatio"="NitrateRedRatio","NitriteRespOTU"="NitriteRed/OTU","NitriteRespRatio"="NitriteRedRatio","NitrogenOxidOTU"="NitrogenOxi/OTU","NitrogenOxidRatio"="NitrogenOxiRatio","NitrRespNonMHCOTU"="NitrRedNonMHC/OTU","NitrRespNonMHCRatio"="NitrRedNonMHCRatio","SulfateRespOTU"="SulfateRed/OTU","SulfateRespRatio"="SulfateRedRatio","SulfurAnyOxidOTU"="SulfurAnyOxi/OTU","SulfurAnyOxidRatio"="SulfurAnyOxiRatio","SulfurAnyRespOTU"="SulfurAnyRed/OTU","SulfurAnyRespRatio"="SulfurAnyRedRatio","NitrogenRespOTU"="NitrogenRed/OTU","NitrogenRespRatio"="NitrogenRedRatio")) +
  scale_y_discrete("y", labels = c("CH4"=expression(CH[4]),"CO2"=expression(CO[2]),"NO3"=expression(NO[3]),"NOX"=expression(NO[X]),"NO2"=expression(NO[2]),"PO4"=expression(PO[4]),"SO4"=expression(SO[4]))) +
  geom_text(aes(label = paste(str_remove(as.character(sprintf("%.3f",p)), "^0+"),"(",N,")")), fontface = "bold", color = ifelse(BH <= 0.05 & N >= 5,'yellow1','white'),size = 2.5) +
  scale_fill_gradient2(limits = c(-1,1),low="red", high="dodgerblue", mid="black", breaks=b, labels=format(b)) + 
  theme(axis.title.x=element_blank(), axis.title.y=element_blank(),
        legend.justification = c(1, 0),
        legend.position = c(1.06, 0.12),
        legend.direction = "vertical") +
  theme(axis.text.x=element_text(angle = -20, hjust = 0)) +
  theme(plot.margin = unit(c(1, 5, .5, 1), "cm")) +
  guides(fill = guide_colorbar(barwidth = 2, barheight = 13, title.position = "top", title.hjust = 0.22))

#reset
METHeatmap <- data.frame(This=character(), withThis=character(), By=character(),Ncorr=numeric(),Ncorr2=numeric(), R=numeric(),RCorr=numeric(),RCorr2=numeric(), p=numeric(),pcorr=numeric(),pcorr2=numeric(), stringsAsFactors=FALSE) # Blank DF

#redoing the environmental vs environmental graph
METHeatmap[nrow(METHeatmap) + 1,] = c("Temperature","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE),cor(Totals_L$Temperature, Totals_L$FeTot, use = "complete.obs"),cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"),cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"),cor.test(Totals_L$Temperature, Totals_L$FeTot, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value) 
METHeatmap[nrow(METHeatmap) + 1,] = c("FeTot","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$CH4), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$CH4), na.rm = TRUE),cor(Totals_L$FeTot, Totals_L$CH4, use = "complete.obs"),cor(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$CH4, use = "complete.obs"),cor(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$CH4, use = "complete.obs"),cor.test(Totals_L$FeTot, Totals_L$CH4, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value) 
METHeatmap[nrow(METHeatmap) + 1,] = c("ODO","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE),cor(Totals_L$ODO, Totals_L$FeTot, use = "complete.obs"),cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"),cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"),cor.test(Totals_L$ODO, Totals_L$FeTot, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value) 
METHeatmap[nrow(METHeatmap) + 1,] = c("FeTot","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$DOC), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$DOC), na.rm = TRUE),cor(Totals_L$FeTot, Totals_L$DOC, use = "complete.obs"),cor(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$DOC, use = "complete.obs"),cor(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$DOC, use = "complete.obs"),cor.test(Totals_L$FeTot, Totals_L$DOC, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value) 
METHeatmap[nrow(METHeatmap) + 1,] = c("pH","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE),cor(Totals_L$pH, Totals_L$FeTot, use = "complete.obs"),cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"),cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"),cor.test(Totals_L$pH, Totals_L$FeTot, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value) 
METHeatmap[nrow(METHeatmap) + 1,] = c("SO4","FeTot","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$FeTot), na.rm = TRUE),cor(Totals_L$SO4, Totals_L$FeTot, use = "complete.obs"),cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"),cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$FeTot, use = "complete.obs"),cor.test(Totals_L$SO4, Totals_L$FeTot, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$FeTot, use = "complete.obs")$p.value) 
METHeatmap[nrow(METHeatmap) + 1,] = c("DOC","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$CH4), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$CH4), na.rm = TRUE),cor(Totals_L$DOC, Totals_L$CH4, use = "complete.obs"),cor(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$CH4, use = "complete.obs"),cor(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$CH4, use = "complete.obs"),cor.test(Totals_L$DOC, Totals_L$CH4, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$DOC, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value) 
METHeatmap[nrow(METHeatmap) + 1,] = c("SO4","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$DOC), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$DOC), na.rm = TRUE),cor(Totals_L$SO4, Totals_L$DOC, use = "complete.obs"),cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$DOC, use = "complete.obs"),cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$DOC, use = "complete.obs"),cor.test(Totals_L$SO4, Totals_L$DOC, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value) 
METHeatmap[nrow(METHeatmap) + 1,] = c("ODO","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$DOC), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$DOC), na.rm = TRUE),cor(Totals_L$ODO, Totals_L$DOC, use = "complete.obs"),cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$DOC, use = "complete.obs"),cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$DOC, use = "complete.obs"),cor.test(Totals_L$ODO, Totals_L$DOC, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value) 
METHeatmap[nrow(METHeatmap) + 1,] = c("pH","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$DOC), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$DOC), na.rm = TRUE),cor(Totals_L$pH, Totals_L$DOC, use = "complete.obs"),cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$DOC, use = "complete.obs"),cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$DOC, use = "complete.obs"),cor.test(Totals_L$pH, Totals_L$DOC, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value) 
METHeatmap[nrow(METHeatmap) + 1,] = c("Temperature","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$DOC), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$DOC), na.rm = TRUE),cor(Totals_L$Temperature, Totals_L$DOC, use = "complete.obs"),cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$DOC, use = "complete.obs"),cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$DOC, use = "complete.obs"),cor.test(Totals_L$Temperature, Totals_L$DOC, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value) 
METHeatmap[nrow(METHeatmap) + 1,] = c("Temperature","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$pH), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$pH), na.rm = TRUE),cor(Totals_L$Temperature, Totals_L$pH, use = "complete.obs"),cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$pH, use = "complete.obs"),cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$pH, use = "complete.obs"),cor.test(Totals_L$Temperature, Totals_L$pH, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value) 
METHeatmap[nrow(METHeatmap) + 1,] = c("Temperature","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$ODO), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$ODO), na.rm = TRUE),cor(Totals_L$Temperature, Totals_L$ODO, use = "complete.obs"),cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$ODO, use = "complete.obs"),cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$ODO, use = "complete.obs"),cor.test(Totals_L$Temperature, Totals_L$ODO, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value) 
METHeatmap[nrow(METHeatmap) + 1,] = c("Temperature","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$CH4), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$CH4), na.rm = TRUE),cor(Totals_L$Temperature, Totals_L$CH4, use = "complete.obs"),cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$CH4, use = "complete.obs"),cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$CH4, use = "complete.obs"),cor.test(Totals_L$Temperature, Totals_L$CH4, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value) 
METHeatmap[nrow(METHeatmap) + 1,] = c("Temperature","SO4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$SO4), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$SO4), na.rm = TRUE),cor(Totals_L$Temperature, Totals_L$SO4, use = "complete.obs"),cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$SO4, use = "complete.obs"),cor(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$SO4, use = "complete.obs"),cor.test(Totals_L$Temperature, Totals_L$SO4, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$Temperature, LakeMETEetRatios_OLR$SO4, use = "complete.obs")$p.value) 
METHeatmap[nrow(METHeatmap) + 1,] = c("pH","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$CH4), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$CH4), na.rm = TRUE),cor(Totals_L$pH, Totals_L$CH4, use = "complete.obs"),cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$CH4, use = "complete.obs"),cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$CH4, use = "complete.obs"),cor.test(Totals_L$pH, Totals_L$CH4, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value) 
METHeatmap[nrow(METHeatmap) + 1,] = c("SO4","pH","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$pH), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$pH), na.rm = TRUE),cor(Totals_L$SO4, Totals_L$pH, use = "complete.obs"),cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$pH, use = "complete.obs"),cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$pH, use = "complete.obs"),cor.test(Totals_L$SO4, Totals_L$pH, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$pH, use = "complete.obs")$p.value) 
METHeatmap[nrow(METHeatmap) + 1,] = c("pH","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$ODO), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$ODO), na.rm = TRUE),cor(Totals_L$pH, Totals_L$ODO, use = "complete.obs"),cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$ODO, use = "complete.obs"),cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$ODO, use = "complete.obs"),cor.test(Totals_L$pH, Totals_L$ODO, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value) 
METHeatmap[nrow(METHeatmap) + 1,] = c("SO4","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$CH4), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$CH4), na.rm = TRUE),cor(Totals_L$SO4, Totals_L$CH4, use = "complete.obs"),cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$CH4, use = "complete.obs"),cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$CH4, use = "complete.obs"),cor.test(Totals_L$SO4, Totals_L$CH4, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value) 
METHeatmap[nrow(METHeatmap) + 1,] = c("ODO","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$CH4), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$CH4), na.rm = TRUE),cor(Totals_L$ODO, Totals_L$CH4, use = "complete.obs"),cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$CH4, use = "complete.obs"),cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$CH4, use = "complete.obs"),cor.test(Totals_L$ODO, Totals_L$CH4, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value) 
METHeatmap[nrow(METHeatmap) + 1,] = c("SO4","ODO","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$ODO), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$ODO), na.rm = TRUE),cor(Totals_L$SO4, Totals_L$ODO, use = "complete.obs"),cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$ODO, use = "complete.obs"),cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$ODO, use = "complete.obs"),cor.test(Totals_L$SO4, Totals_L$ODO, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$ODO, use = "complete.obs")$p.value) 
#METHeatmap[nrow(METHeatmap) + 1,] = c("FeTot","DOCorTOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$DOCorTOC), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$DOCorTOC), na.rm = TRUE),cor(Totals_L$FeTot, Totals_L$DOCorTOC, use = "complete.obs"),cor(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$DOCorTOC, use = "complete.obs"),cor(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$DOCorTOC, use = "complete.obs"),cor.test(Totals_L$FeTot, Totals_L$DOCorTOC, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$DOCorTOC, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$FeTot, LakeMETEetRatios_OLR$DOCorTOC, use = "complete.obs")$p.value) 
#METHeatmap[nrow(METHeatmap) + 1,] = c("DOCorTOC","DOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$DOCorTOC, LakeMETEetRatios_OLR$DOC), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$DOCorTOC, LakeMETEetRatios_OLR$DOC), na.rm = TRUE),cor(Totals_L$DOCorTOC, Totals_L$DOC, use = "complete.obs"),cor(LakeMETEetRatios_OLR$DOCorTOC, LakeMETEetRatios_OLR$DOC, use = "complete.obs"),cor(LakeMETEetRatios_OLR$DOCorTOC, LakeMETEetRatios_OLR$DOC, use = "complete.obs"),cor.test(Totals_L$DOCorTOC, Totals_L$DOC, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$DOCorTOC, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$DOCorTOC, LakeMETEetRatios_OLR$DOC, use = "complete.obs")$p.value) 
#METHeatmap[nrow(METHeatmap) + 1,] = c("pH","DOCorTOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$DOCorTOC), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$DOCorTOC), na.rm = TRUE),cor(Totals_L$pH, Totals_L$DOCorTOC, use = "complete.obs"),cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$DOCorTOC, use = "complete.obs"),cor(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$DOCorTOC, use = "complete.obs"),cor.test(Totals_L$pH, Totals_L$DOCorTOC, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$DOCorTOC, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$pH, LakeMETEetRatios_OLR$DOCorTOC, use = "complete.obs")$p.value) 
#METHeatmap[nrow(METHeatmap) + 1,] = c("ODO","DOCorTOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$DOCorTOC), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$DOCorTOC), na.rm = TRUE),cor(Totals_L$ODO, Totals_L$DOCorTOC, use = "complete.obs"),cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$DOCorTOC, use = "complete.obs"),cor(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$DOCorTOC, use = "complete.obs"),cor.test(Totals_L$ODO, Totals_L$DOCorTOC, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$DOCorTOC, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$ODO, LakeMETEetRatios_OLR$DOCorTOC, use = "complete.obs")$p.value) 
#METHeatmap[nrow(METHeatmap) + 1,] = c("DOCorTOC","CH4","Lake",sum(complete.cases(LakeMETEetRatios_OLR$DOCorTOC, LakeMETEetRatios_OLR$CH4), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$DOCorTOC, LakeMETEetRatios_OLR$CH4), na.rm = TRUE),cor(Totals_L$DOCorTOC, Totals_L$CH4, use = "complete.obs"),cor(LakeMETEetRatios_OLR$DOCorTOC, LakeMETEetRatios_OLR$CH4, use = "complete.obs"),cor(LakeMETEetRatios_OLR$DOCorTOC, LakeMETEetRatios_OLR$CH4, use = "complete.obs"),cor.test(Totals_L$DOCorTOC, Totals_L$CH4, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$DOCorTOC, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$DOCorTOC, LakeMETEetRatios_OLR$CH4, use = "complete.obs")$p.value) 
#METHeatmap[nrow(METHeatmap) + 1,] = c("SO4","DOCorTOC","Lake",sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$DOCorTOC), na.rm = TRUE),sum(complete.cases(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$DOCorTOC), na.rm = TRUE),cor(Totals_L$SO4, Totals_L$DOCorTOC, use = "complete.obs"),cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$DOCorTOC, use = "complete.obs"),cor(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$DOCorTOC, use = "complete.obs"),cor.test(Totals_L$SO4, Totals_L$DOCorTOC, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$DOCorTOC, use = "complete.obs")$p.value,cor.test(LakeMETEetRatios_OLR$SO4, LakeMETEetRatios_OLR$DOCorTOC, use = "complete.obs")$p.value) 

r <- as.numeric(METHeatmap$RCorr2)
p <- as.numeric(METHeatmap$pcorr2) # p <- METHeatmap$pcorr2 %>% p.adjust(method = "BH")
BH <- METHeatmap$pcorr2 %>% p.adjust(method = "BH")
N <- as.numeric(METHeatmap$Ncorr2)

b <- c(-1, 0, 1)
x <- METHeatmap$This
y <- METHeatmap$withThis

data <- data.frame(x,y,r,p,N,BH)
ggplot(data, aes(x, y)) + 
  geom_tile(aes(fill = r), color = "white",lwd=.5) + 
  scale_y_discrete("y", labels = c("CH4"=expression(CH[4]),"SO4"=expression(SO[4]))) +
  scale_x_discrete("x", labels = c("CH4"=expression(CH[4]),"SO4"=expression(SO[4]))) +
  geom_text(aes(label = paste(str_remove(as.character(sprintf("%.3f",p)), "^0+"),"(",N,")")), fontface = "bold", color = ifelse(BH <= 0.05,'yellow1','white')) +
  scale_fill_gradient2(limits = c(-1,1),low="red", high="dodgerblue", mid="black", breaks=b, labels=format(b)) + 
  theme(axis.title.x=element_blank(), axis.title.y=element_blank(),
        legend.justification = c(1, 0),
        legend.position = c(0.4, 0.65),
        legend.direction = "horizontal") +
  guides(fill = guide_colorbar(barwidth = 9, barheight = 2, title.position = "top", title.hjust = 0.5))


#calculating EET ratios total:
sum(TaxMetEetCombWbin$totalEET_PA == "0") #= 2693 # this time: 2691
sum(TaxMetEetCombWbin$totalEET_PA == "1") #= 2876 # this time: 2878 = 52%
sum(TaxMetEetCombWbin$totalEET == "1") # 484
sum(TaxMetEetCombWbin$totalEET >= "2") # 1988 = 24.34% of EET bins were 1 EET gene and 36% of organisms in bog and thermokarst have 2 or more EET genes.
#5569 total bins
#how many chlorobi have EET genes
chlorobi_withRespEET <- filter(filter(TaxMetEet, totalEET == "0"), Class == "Chlorobia" )
sum(chlorobi_withRespEET$totalEET == "0") # = 4
sum(TaxMetEet$totalEET == "0" & TaxMetEet$Class == "Chlorobia" ) #cool also works
sum(TaxMetEet$Class == "Chlorobia" ) #320
sum(TaxMetEet$totalEET > 0 & TaxMetEet$Class == "Chlorobia" ) # 318 = 99.38% of all #this time 316 = 98.75%
mean(LakeMETEetRatios_OLR$SO4,na.rm=TRUE) # = 1.4mg/L

Gamma_withOxidEET <- filter(filter(TaxMetEet, OxidEET > 0), Class == "Gammaproteobacteria" )
Desulfuro_withOxidEET <- filter(filter(TaxMetEet, OxidEET > 0), Class == "Desulfuromonadia" )
Alpha_withOxidEET <- filter(filter(TaxMetEet, OxidEET > 0), Class == "Alphaproteobacteria" )

#trying to put histogram together with bar chart
#totalEET first p1 = bar chart of totalEET number taxa dist 
p1 <- ggplot(ClassCountsX, aes(x = EETcount, y = OTU.Proportion,fill=Group)) + geom_bar(stat='identity', color="black", size=.2) + geom_text(aes(label = ifelse(OTU.Proportion > .005, Group, "")), position = position_stack(vjust = .5),size = 2.5) + theme(legend.position = "none") 
#p2 is from Outliers_UniqueByLakecno.R, a graph of the histogram
plot_grid(p2, p1 , labels = "AUTO",nrow=2, align = "v", rel_heights = c(1,5))
# I give up. I'll just put them together in powerpoint afterwards. Plus I don't want to simultaneously display zero with the rest 
#line up separately in powerpoint ... all EET genes over zero
Totals_otuF <- TaxMetEet
Totals_otuF <- filter(Totals_otuF, totalEET > 0 & totalEET < 25)
Totals_otuF$totalEET <- factor(Totals_otuF$totalEET, levels = c("X",0:25))
ggplot(Totals_otuF, aes(totalEET)) +
  geom_bar(fill = 'black') +
  labs(x = 'Number of EET proteins', y = 'Number of OTUs') 
#line up separately in powerpoint ... all oxid EET genes over zero
Totals_otuF <- TaxMetEet
Totals_otuF <- filter(Totals_otuF, OxidEET > 0 & OxidEET < 16)
Totals_otuF$OxidEET <- factor(Totals_otuF$OxidEET, levels = c("X",0:20))
ggplot(Totals_otuF, aes(OxidEET)) +
  geom_bar(fill = 'black') +
  labs(x = 'Number of EET proteins', y = 'Number of OTUs')
#line up separately in powerpoint ... all resp EET genes over zero
Totals_otuF <- TaxMetEet
Totals_otuF <- filter(Totals_otuF, RespEET > 0 & RespEET < 19)
Totals_otuF$RespEET <- factor(Totals_otuF$RespEET, levels = c("X",0:20))
ggplot(Totals_otuF, aes(RespEET)) +
  geom_bar(fill = 'black') +
  labs(x = 'Number of EET proteins', y = 'Number of OTUs') 

#line up separately in powerpoint ... all Undescribed EET genes over zero
Totals_otuF <- TaxMetEet
Totals_otuF <- filter(Totals_otuF, undescribed > 0 & undescribed < 16)
Totals_otuF$undescribed <- factor(Totals_otuF$undescribed, levels = c("X",0:20))
ggplot(Totals_otuF, aes(undescribed)) +
  geom_bar(fill = 'black') +
  labs(x = 'Number of EET genes in an OTU', y = 'Number of OTUs') 

#line up separately in powerpoint ... all Dissimilar EET genes over zero
Totals_otuF <- TaxMetEet
Totals_otuF <- filter(Totals_otuF, dissimilar > 0 & dissimilar < 13)
Totals_otuF$dissimilar <- factor(Totals_otuF$dissimilar, levels = c("X",0:20))
ggplot(Totals_otuF, aes(dissimilar)) +
  geom_bar(fill = 'black') +
  labs(x = 'Number of EET proteins', y = 'Number of OTUs') 

#line up separately in powerpoint ... all BOTH EET genes over zero
Totals_otuF <- TaxMetEet
Totals_otuF <- filter(Totals_otuF, totalEET > 1 & OxidEET > 0 & RespEET > 0 & totalEET < 24)
Totals_otuF$totalEET <- factor(Totals_otuF$totalEET, levels = c("X",0:25))
ggplot(Totals_otuF, aes(totalEET)) +
  geom_bar(fill = 'black') +
  labs(x = 'Number of EET proteins', y = 'Number of OTUs') 
#exported pdfs for number of otus vs EET proteins
#Respiratory: (trying .85 times t)
# 22.4x5.1 => 19.04x2.42in (y was the minimum)
#Oxidative: (.88 times total)
# 19x5 => 16.72x2.42
#Novel: (.857 times total)
# 13.7x2.42
#Total: (.923 times total)
#26.76x2.42

#Looking at specific classes with EET genes:
chlorobi_withRespEET <- filter(filter(TaxMetEet, totalEET == "0"), Class == "Chlorobia" )
Gammaproteobacteria_withRespEET <- filter(filter(TaxMetEet, dissimilar >= "1"), Class == "Gammaproteobacteria" )
Verrucomicrobia_withDissEET <- filter(filter(TaxMetEet, dissimilar >= "1"), Class == "Verrucomicrobiae" )
Planctomycetota_withDissEET <- filter(filter(TaxMetEet, dissimilar >= "1"), Phylum == "Planctomycetota" )
Myxococcota_withDissEET <- filter(filter(TaxMetEet, dissimilar >= "1"), Phylum == "Myxococcota" )


#How many bacteria have only EET as redox?
filter(Totals_otuF, totalEET > 1 & OxidEET > 0 & RespEET > 0 & totalEET < 24)
#How many bacteria have only EET as redox?
temp <- filter(TaxMetEetCombinedUniqueOTU, totalEET > 0 & AnyKindResp < 1 & InorganicOxid < 1) # = 97 #uniqued 43
#same also without C1 oxidation
temp <- filter(TaxMetEetCombinedUniqueOTU, totalEET > 0 & AnyKindResp < 1 & InorganicOxid < 1 & C1Oxid < 1) # = 54 #uniqued 26
#How many EET respiring bacteria have no other form of respiration
temp <- filter(TaxMetEetCombinedUniqueOTU, RespEET > 0 & AnyKindResp < 1) #143(450 1 or less) out of 2171 EETResp bacteria = 7% #uniqued; 69 (247 1 or less) have RespEET and no other kind of Resp out of 1095 RespEET = 6.3%
temp <- filter(TaxMetEetCombinedUniqueOTU, RespEET > 0 & OxidEET > 0) #1266 have both Resp and Oxid EET #uniqued: 616 have both
#How many EET oxidizing bacteria have no other form of inorganic oxidation
temp <- filter(TaxMetEetCombinedUniqueOTU, OxidEET > 0 & InorganicOxid < 1) # = 275 out of 1827 (1194, OxudEET> 1) #uniqued 167 out of 937 (598, OxidEET>1)
temp <- filter(TaxMetEetCombinedUniqueOTU, OxidEET > 0 & InorganicOxid < 1 & C1Oxid < 1) # 187 = 10.2% #uniqued 122 = 13%
#How many EET oxidizing bacteria without any other form of oxidation have a resp EET gene?
temp <- filter(TaxMetEetCombinedUniqueOTU, OxidEET > 0 & InorganicOxid < 1 & C1Oxid < 1 & RespEET > 0) # = 118 #uniqued 75
#How many EET respiring bacteria without any other form of respiration have a OxidEET gene?
temp <- filter(TaxMetEetCombinedUniqueOTU, RespEET > 0 & AnyKindResp < 1 & OxidEET > 0) # = 67 #uniqued 35
#how many EET bacteria with both Respiring and Oxidizing genes have no other form of Oxidation?
temp <- filter(TaxMetEetCombinedUniqueOTU, RespEET > 0 & OxidEET > 0 & InorganicOxid < 1 & C1Oxid < 1) #= 185 and 118 without methane oxidation #uniqued 110 and 75 without methane oxidation
#how many EET bacteria with both Respiring and Oxidizing genes have no other form of respiration?
temp <- filter(TaxMetEetCombinedUniqueOTU, RespEET > 0 & OxidEET > 0 & AnyKindResp < 1) #67 #uniqued 35
temp <- filter(TaxMetEetCombinedUniqueOTU, RespEET + undescribed > 0 & OxidEET > 0 & AnyKindResp < 1) #= 69 #uniqued 37
#how many that have both redox EET don't have any other redox?
temp <- filter(TaxMetEetCombinedUniqueOTU, RespEET > 0 & OxidEET > 0 & AnyKindResp < 1 & InorganicOxid < 1 & C1Oxid < 1) #4 or only 29 excluding C1Oxid < 1 ... (all 4 are included in both the 67 and the 118, and none of the  4 have dissimilar or undescribed) # uniqued: 3 or only 10 excluding C1Oxid<1 (and all three have no dissimilar, and are included in both the 35 and 75)
#how many have an undescribed EET gene but no other known respEET and no known non-EET resp
temp <- filter(TaxMetEetCombinedUniqueOTU, undescribed > 0 & RespEET < 1 & AnyKindResp < 1) # = 23, only 2 of which have oxidative EET #15 only 2 of which have oxidative EET
temp <- filter(TaxMetEetCombinedUniqueOTU, undescribed > 0 & RespEET < 1 & AnyKindResp < 1 & InorganicOxid < 1 & C1Oxid < 1) # 9 only 1 of which has OxidEET #uniqued: 6, only 1 of which has OxidEET 
#So (118 + 67(or 69 if you include undescribed) - 4) out of 1266 = 14.29% 
#Uniqued So (75 +35(or 37 if including undescribed) - 3) out of 616 = 17.37%

#do the Planctomycetota have anammox? first check that "InorganicOxid" is only hzoA + hzaA.
temp1 <- filter(TaxMetEetCombinedUniqueOTU, Phylum == "Planctomycetota" & totalEET > 1) #63 out of 139 total Planctomycetota
temp1 <- filter(TaxMetEetCombinedUniqueOTU, Phylum == "Planctomycetota" & totalEET > 1 & InorganicOxid > 0) #NONE
temp1 <- filter(TaxMetEetCombinedUniqueOTU, Phylum == "Planctomycetota" & InorganicOxid > 0) # NONE... hmm
temp1 <- filter(TaxMetEetCombinedUniqueOTU, InorganicOxid > 0) #none?
temp1 <- filter(TaxMetEet, hzsA > 0) #none?

#how many with respiratory redox have no oxidative redox other than EET?
temp1 <- filter(TaxMetEetCombinedUniqueOTU, undescribed + AnyKindResp + RespEET > 0 & InorganicOxid < 1 & C1Oxid < 1 & OxidEET > 0) # = 177 (1164 without the OxidEET > 0 part, so 90% of respiratory organisms no known form of inorganic oxidation, suggesting organic oxidation) #uniqued = 117 and 743 without the  & OxidEET > 0 part, so 84% of resp have no known form of inorganic oxdation
temp2 <- filter(TaxMetEetCombinedUniqueOTU, AnyKindResp > 0 & InorganicOxid < 1 & C1Oxid < 1 & OxidEET > 0) # = 172 #uniqued = 113

#how many with oxidative redox have no respiratory redox other than EET?
temp1 <- filter(TaxMetEetCombinedUniqueOTU, InorganicOxid + OxidEET + C1Oxid > 0 & AnyKindResp < 1 & RespEET > 0) # 104 (348 without the Resp > 0 part, so 30% (organism with oxidation and no nonEET respiration with EET respiration / organism with oxidation and no nonEET respiration) so 70% of organisms have oxidation but no known form of respiration. # uniqued = 57
temp2 <- filter(TaxMetEetCombinedUniqueOTU, InorganicOxid + C1Oxid > 0 & AnyKindResp < 1 & RespEET > 0) #100 #uniqued = 54

temp1 <- filter(TaxMetEetCombinedUniqueOTU, totalEET>0)
#  277 out of 2878 = ~10%
# uniqued: 171 out of 1500

#Finding exact number of single EET genes that are bad evidence of mOTUs like DFE alone or FoxZ alone (not with a FoxE)
temp1 <- filter(TaxMetEetCombinedUniqueOTU, totalEET > 0)
write.csv(temp1, "/Users/cnolmsted/Documents/MchMahon_Lab/Manuscripts/Water-EET-paper/Supplimental_Tables/WorkingFiles/SingleEETgenemOTUs.csv") 

#What can fix carbon?
temp1 <- filter(TaxMetEetCombined, Genus == "Rhodoferax")
#Chlorobia often has Form IV rubisco and/or ac1A/ac1B RTCA cycle
#Rhodoferax Form II rubisco and Propyonyl-CoA synthase(prpE), sometimes ac1A
#Magnetospirilaceae Form II and prpE
#Rhodopila: Form II or IV and prpE

#Which EET bacteria have methyl or methanotrophy? and what percent had an oxidizing gene
temp1 <- filter(TaxMetEetCombinedUniqueOTU, Family == "Methylophilaceae", totalEET > 0) #101 #113total
temp1 <- filter(TaxMetEetCombinedUniqueOTU, totalEET > 0 & Family == "Methylophilaceae" & OxidEET > 0) #66
temp1 <- filter(TaxMetEetCombinedUniqueOTU, Order == "Methylococcales") #121
temp1 <- filter(TaxMetEetCombinedUniqueOTU, Order == "Methylococcales" &  totalEET > 0 & OxidEET > 0) # 107/121 , 101/121
#pmoABC particulate or mmoBD soluble methane monooxygenases.
temp1 <- filter(TaxMetEetCombinedUniqueOTU, Order == "Methylococcales" &  totalEET > 0 & pmoA < 1 & pmoB < 1 & pmoC < 1 & mmoB < 1 & mmoD < 1)
temp1 <- filter(TaxMetEetCombinedUniqueOTU, totalEET > 0 & Order == "Methylococcales" & RespEET > 1) 
temp1 <- filter(TaxMetEetCombinedUniqueOTU, MethaneProduction > 0) # only 8? one from a thermokarst the rest from Alinen Must_arjv or whatever
#How many family Methylophilaceae have at least one EET gene? = 147 out of 182 total and (90 2 or more) and 65 have OxidEET = 44%:36%
#How many order Methylococcales have at least on EET? = 169 out of 257 (101 2 or more) and 154 have OxidEET = 91%:63%
temp1 <- filter(TaxMetEetCombined, totalEET > 0 & Class == "Actinobacteria") #6 #uniqued=4
temp1 <- filter(TaxMetEetCombinedUniqueOTU, Class == "Actinobacteria") #647 #uniqued=358
temp1 <- filter(TaxMetEetCombinedUniqueOTU, Class == "Thermoleophilia" & totalEET > 0)
temp1 <- filter(TaxMetEetCombined, totalEET > 0 & Class == "Planctomycetes") #33
temp1 <- filter(TaxMetEetCombined, Class == "Planctomycetes") #48
temp1 <- filter(TaxMetEetCombined, totalEET > 0 & Class == "Saccharimonadia") #0
temp1 <- filter(TaxMetEetCombined, Class == "Saccharimonadia") #59
temp1 <- filter(TaxMetEetCombined, Class == "Alphaproteobacteria" & OxidEET == 13)
temp1 <- filter(TaxMetEetCombined, Class == "Gammaproteobacteria" & OxidEET == 7)
temp1 <- filter(TaxMetEetCombined, Class == "Gammaproteobacteria" & RespEET == 5)
temp1 <- filter(TaxMetEetCombined, Class == "Desulfuromonadia" & RespEET == 6)
temp1 <- filter(TaxMetEetCombined, Phylum == "Planctomycetota")
temp1 <- filter(TaxMetEetCombined, Genus == "Polynucleobacter" & OxidEET == 5)

temp1 <- filter(TaxMetEetCombined, Class == "Gammaproteobacteria" & totalEET > 1 & Genus == "Rhodoferax" & OxidEET > 2 & RespEET > 2) #182/954 = Rhodoferax/Gamma 173oxid
temp1 <- filter(TaxMetEetCombined, Class == "Gammaproteobacteria" & Genus == "Polynucleobacter") #249 total 81w/1 46 w/2 EET
temp1 <- filter(TaxMetEetCombined, Class == "Gammaproteobacteria" & Genus == "Rhodoferax" & RespEET > 1)
#Vampirovibrionia

#5569 total bins, 2878 have at least 1 EET
colnames(TaxMetEetCombined)

############### How many unique taxonomies are there? And which are new to our knowledge of EET and which are not ###########
# TaxMETEetCombined
# Make file with unique taxonomies for organisms who at least one EET gene was found in
TaxMetEetNumberOnly <- TaxMetEetCombined[c(3,11:18,22:231,233:264)]
TaxMetEetNumOnlyEET <- filter(TaxMetEetNumberOnly, totalEET > 0)

EETTaxaUnique <- TaxMetEetNumOnlyEET %>% group_by(classification) %>% summarise_all(funs(mean,sd))

#Without considering only those that have EET
TaxaUnique  <- TaxMetEetNumberOnly %>% group_by(classification) %>% summarise_all(funs(mean,sd))

colnames(EETTaxaUnique)
#easier to view:
EETTaxaUniqueEasy <- EETTaxaUnique[c(1,212:218,462:468)]
TaxMetEetCombinedEasy <- filter(TaxMetEetCombined, totalEET > 0)
colnames(TaxMetEetCombinedEasy)
TaxMetEetCombinedEasy <- TaxMetEetCombinedEasy[c(1,2,3,232,224:231,233:244)]
write.csv(EETTaxaUniqueEasy, "/Users/cnolmsted/Documents/MchMahon_Lab/Manuscripts/Water-EET-paper/Supplimental_Tables/WorkingFiles/UniqueEETtaxaAverages.csv") 

# Highlighting specific genera as though they were their own class: Polynucleobacter, Limnohabitans, Rhodoferax
# for each EET number taxa graph, run the following right after line 22 and continue as normal.
# This will replace the Class with the genus name if it matches any of the desired genera.  #Methylophilaceae

TaxMetEet <- TaxMetEet %>% mutate(Class = ifelse(Genus == "Polynucleobacter" | Genus == "Limnohabitans" | Genus == "Rhodoferax" | Genus == "Geothrix" | Genus  == "Sterolibacterium", Genus, Class))
#other options: Sterolibacterium
#Or perhaps I want to higlight a family? Methylophilaceae
TaxMetEet <- TaxMetEet %>% mutate(Class = ifelse(Family == "Methylophilaceae", Family, Class))
#Other options Magnetospirillaceae, Acetobacteraceae
#Or perhaps I want to highlight an Order? Methylococcales
TaxMetEet <- TaxMetEet %>% mutate(Class = ifelse(Order == "Methylococcales" | Order == "Geobacterales", Order, Class))


#replacing each paste("other_" with paste("" since I'm mixing taxa levels anyways now. 

#playing with graph size:
#total, 26 columns Exporting png to 2900x500 just fits Gamma. 
#pdf = 29 x 5.8 inches
#Both 25 columns to 2500x500 just fits Gamma
#Oxid 17 columns 1900x500 just fits gamma
#pdf = 19x5
#Resp 20 columns 2200x500 just fits gamma
#pdf = 22.4x5.1
#Diss 14 columns 1600x500 just fits gamma


#need to make a version of TaxMetCombined where each mOTU is only represented once per lake and it's the most complete least contaminated version. And then redo all the X% OTUs have X characteristics statements. 
#replacing all blanks with NA
TaxMetEetCombinedNA <- TaxMetEetCombined %>% mutate_all(na_if,"")
#replacing NA mOTUs with user_genome Lake identifier separated by "__" so that it does not group those without known mOTUs as the same thing
TaxMetEetCombinedNA <- TaxMetEetCombinedNA %>% mutate(mOTU=ifelse(is.na(mOTU), paste(user_genome, Lake, sep = "__"), mOTU))
#finding a single mOTU per lake, or not if no mOTU known, and specifically grabbing only the one with the highest completness-contamination value
TaxMetEetCombinedUniqueOTU <- TaxMetEetCombinedNA %>% group_by(mOTU, Lake) %>% slice(which.max(completeness - contamination))
TaxMetEetCombinedUniqueJustOTU <- TaxMetEetCombinedNA %>% group_by(mOTU) %>% slice(which.max(completeness - contamination))
#Now recalculate all the values in the paper using TaxMetEetCombinedUniqueOTU
#out of 3030 mOTUs unique per lake
temp <- filter(TaxMetEetCombinedUniqueOTU, totalEET > 1) #49.5% with more than zero EET, and 40.3 with 2 or more, so that's respectively 47.6% excluding poor evidence singlets like DFE

#Try False discovery rate test 'Mulutitest' Benjamini-Hochberg False Discovery rate correction
#https://stat.ethz.ch/R-manual/R-devel/library/stats/html/p.adjust.html

METHeatmap$p %>% p.adjust
METHeatmap$p %>% p.adjust(method = "BH")
# simply change line 719 "p <- as.numeric(METHeatmap$p)" to "p <- METHeatmap$p %>% p.adjust(method = "BH")"

write.csv(TaxMetEetCombined,"/Users/cnolmsted/Documents/MchMahon_Lab/Manuscripts/Water-EET-paper/Supplimental_Tables/WorkingFiles/TaxMetEetCombined.csv")

# Cyc2 specific questions:

Cyc2or1perOTUs <- read.csv(file = "/Users/cnolmsted/Documents/MchMahon_Lab/Manuscripts/BorealLakeEETpaper/Supplimental_Tables/WorkingFiles/Cyc2andEETsplitPerOTU.csv", header = TRUE, stringsAsFactors=FALSE)
TaxMetEetOTUcyc2 <- left_join(TaxMetEetCombinedUniqueOTU, Cyc2or1perOTUs, by=c("user_genome"="user_genome","Sample"="Sample"))

temp1 <- filter(TaxMetEetOTUcyc2, Order == "Methylococcales" & OxidEET > 0 & NumberofCyc2orCyc1 > 0) 
# 84/101 methylococcales OTUs with oxidative EET have Cyc2
temp1 <- filter(TaxMetEetOTUcyc2, Order == "Methylococcales" & OxidEET > NumberofCyc2orCyc1) 
#60/101 with oxidative EET have non-Cyc2 oxidative eet genes
temp1 <- filter(TaxMetEetOTUcyc2, Family == "Methylophilaceae" & OxidEET > 0 & NumberofCyc2orCyc1 > 0) 
# 50/66 Methylophilaceae with oxidative EET have Cyc2
temp1 <- filter(TaxMetEetOTUcyc2, Family == "Methylophilaceae" & OxidEET > NumberofCyc2orCyc1) 
#33 out of 66 have other non-Cyc2 oxidative EET genes.

temp1 <- filter(TaxMetEetOTUcyc2, totalEET > 0 & totalEET == NumberofCyc2orCyc1) # 218 OTUs have only Cyc2 and no other EET gene
temp1 <- filter(TaxMetEetOTUcyc2, totalEET == 0) # 1530 have zero EET genes
temp1 <- filter(TaxMetEetOTUcyc2, NumberofCyc2orCyc1 > 0 & totalEET > NumberofCyc2orCyc1) # 484 OTUs that have Cyc2 have additional EET genes
temp1 <- filter(TaxMetEetOTUcyc2, NumberofCyc2orCyc1 > 0) # 704 OTUs have Cyc2

temp1 <- filter(TaxMetEetOTUcyc2, NumberofCyc2orCyc1 > 0 & RespEET > 0) #444
temp1 <- filter(TaxMetEetOTUcyc2, NumberofCyc2orCyc1 > 0 & dissimilar > 0) #152
temp1 <- filter(TaxMetEetOTUcyc2, NumberofCyc2orCyc1 < OxidEET) #453
#Coocurrs very frequently with MtoA and MtrB

colnames(TaxMetEetOTUcyc2)
names(TaxMetEetOTUcyc2)[91] <- "Form_I"
names(TaxMetEetOTUcyc2)[92] <- "Form_II"
names(TaxMetEetOTUcyc2)[93] <- "Form_II.III"
names(TaxMetEetOTUcyc2)[94] <- "Form_III"
names(TaxMetEetOTUcyc2)[95] <- "Form_IV"
names(TaxMetEetOTUcyc2)[100] <- "x4hbl"

temp1 <- filter(TaxMetEetOTUcyc2, Order == "Methylococcales" & OxidEET == 0)#20

#how many methylotrophs that have Oxidative EET (101, 84Cyc2) have nitrogen fixation?
temp1 <- filter(TaxMetEetOTUcyc2, Order == "Methylococcales" & OxidEET > 0 & anfD + anfK + anfG + nifD + nifK + vnfD + vnfK + vnfG + nifH > 0)
# 52 and 41Cyc2 did 
# how many without OxidEET had N-fixation?
temp1 <- filter(TaxMetEetOTUcyc2, Order == "Methylococcales" & OxidEET == 0 & anfD + anfK + anfG + nifD + nifK + vnfD + vnfK + vnfG + nifH > 0)
#8 did 
#without any EET?
temp1 <- filter(TaxMetEetOTUcyc2, Order == "Methylococcales" & totalEET == 0 & anfD + anfK + anfG + nifD + nifK + vnfD + vnfK + vnfG + nifH > 0)
#7 did

#carbon fixation?
temp2 <- filter(TaxMetEetOTUcyc2, Order == "Methylococcales" & OxidEET > 0 & Form_I + Form_II + Form_II.III + Form_III + Form_IV + prpE + mcr + K15017 + K14466 + x4hbl + K18861 + E6.2.1.56 + abfD + cdhD + cdhE + cooS + aclA + aclB > 0) # 52 and 41Cyc2
# 8 and 7 also with Cyc2 did
#without OxidEET?
temp1 <- filter(TaxMetEetOTUcyc2, Order == "Methylococcales" & totalEET == 0 & Form_I + Form_II + Form_II.III + Form_III + Form_IV + prpE + mcr + K15017 + K14466 + x4hbl + K18861 + E6.2.1.56 + abfD + cdhD + cdhE + cooS + aclA + aclB > 0) # 52 and 41Cyc2
# 0 did, also 0 with totalEET==0

temp1 <- filter(TaxMetEetOTUcyc2, Family == "Methylophilaceae" & OxidEET > 0 )
#how many methylotrophs that have Oxidative EET (66, 50Cyc2) have nitrogen fixation?
temp1 <- filter(TaxMetEetOTUcyc2, Family == "Methylophilaceae" & OxidEET > 0 & anfD + anfK + anfG + nifD + nifK + vnfD + vnfK + vnfG + nifH > 0)
# 0 did
# how many without OxidEET had N-fixation?
temp1 <- filter(TaxMetEetOTUcyc2, Family == "Methylophilaceae" & OxidEET == 0 & anfD + anfK + anfG + nifD + nifK + vnfD + vnfK + vnfG + nifH > 0)
#1 did 
#without any EET?
temp1 <- filter(TaxMetEetOTUcyc2, Family == "Methylophilaceae" & totalEET == 0 & anfD + anfK + anfG + nifD + nifK + vnfD + vnfK + vnfG + nifH > 0)
#0 did

#carbon fixation?
temp2 <- filter(TaxMetEetOTUcyc2, Family == "Methylophilaceae" & OxidEET > 0 & Form_I + Form_II + Form_II.III + Form_III + Form_IV + prpE + mcr + K15017 + K14466 + x4hbl + K18861 + E6.2.1.56 + abfD + cdhD + cdhE + cooS + aclA + aclB > 0) # 52 and 41Cyc2
# 8 and 8 also with Cyc2 did
#without OxidEET?
temp2 <- filter(TaxMetEetOTUcyc2, Family == "Methylophilaceae" & OxidEET == 0 & Form_I + Form_II + Form_II.III + Form_III + Form_IV + prpE + mcr + K15017 + K14466 + x4hbl + K18861 + E6.2.1.56 + abfD + cdhD + cdhE + cooS + aclA + aclB > 0) # 52 and 41Cyc2
# 2 did, also 0 with totalEET==0

temp1 <- filter(TaxMetEetCombinedUniqueOTU, Order == "Methylococcales" &  OxidEET > 0 & pmoA + pmoB + pmoC + mmoB + mmoD == 0) #82/107totalEET>0 and 9/14 with totalEET==0
temp1 <- filter(TaxMetEetCombinedUniqueOTU, Order == "Methylococcales" & OxidEET > 0)
#20 no oxid EET, 121 total Methylococcales, 101 with oxid EET, 82 with oxidEET and a methane monooxygenase, 12 without oxidEET and a methane monooxygenase, 8 neither oxidEET nor monoxygenase, 19 oxidEET but no monoxygenase.
#what percent had novel
temp1 <- filter(TaxMetEetCombinedUniqueOTU, dissimilar > 0)

#how many have novel EET genes but no other kind of gene
temp1 <- filter(TaxMetEetCombinedEasy, totalEET > 0 & RespEET == 0 & OxidEET == 0) 
temp1 <- filter(TaxMetEetCombinedEasy, totalEET > 0 & RespEET == 0 & OxidEET == 0 & dissimilar > 0) 

#sum of Cyc2 per OTUs
sum(Cyc2or1perOTUs$NumberofCyc2orCyc1)#1298
sum(TaxMetEetOTUcyc2$NumberofCyc2orCyc1)#1298
sum(TaxMetEetOTUcyc2$OxidEET) #2181
#if you want to remove all Cyc2 from consideration rerun everything but instead of line 15 run the next line without the hashtag
#MetabolicEET <- read.csv(file = "/Users/cnolmsted/Documents/MchMahon_Lab/EET_sequencing_stuff/FeGenie/EET-finder-Pipeline_plusD-Bond/Edited_Pipeline_Files/METABOILCandEETinfoMinusCyc2.csv", header = FALSE, stringsAsFactors=FALSE)
#Or if you want to remove all MtoA from consideration rerun everything but instead of line 15 run the next line without the hashtag
#MetabolicEET <- read.csv(file = "/Users/cnolmsted/Documents/MchMahon_Lab/EET_sequencing_stuff/FeGenie/EET-finder-Pipeline_plusD-Bond/Edited_Pipeline_Files/METABOILCandEETinfoCorrectedminusMtoA.csv", header = FALSE, stringsAsFactors=FALSE)
#Or if you want remove everything other than Cyc2 from consideration rerun everything but instead of line 15 run the next line without the hashtag
#MetabolicEET <- read.csv(file = "/Users/cnolmsted/Documents/MchMahon_Lab/EET_sequencing_stuff/FeGenie/EET-finder-Pipeline_plusD-Bond/Edited_Pipeline_Files/METABOILCandEEToxiiscyc2.csv", header = FALSE, stringsAsFactors=FALSE)
#Or if you want remove everything other than MtoA from consideration rerun everything but instead of line 15 run the next line without the hashtag
MetabolicEET <- read.csv(file = "/Users/cnolmsted/Documents/MchMahon_Lab/EET_sequencing_stuff/FeGenie/EET-finder-Pipeline_plusD-Bond/Edited_Pipeline_Files/METABOILCandEETMtoAonly.csv", header = FALSE, stringsAsFactors=FALSE)


#exporting correlation charts as TIFFs sizes:
#EETvsEET = 12.48x6in
